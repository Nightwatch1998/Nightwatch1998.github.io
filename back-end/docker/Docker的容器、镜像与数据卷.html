<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Docker的容器、镜像与数据卷 | NightWatch</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/images/favicon.png">
    <meta name="description" content="编程，从入门到入土">
    
    <link rel="preload" href="/assets/css/0.styles.4c261fea.css" as="style"><link rel="preload" href="/assets/js/app.5f3ce635.js" as="script"><link rel="preload" href="/assets/js/2.4829a41e.js" as="script"><link rel="preload" href="/assets/js/1.21e39df5.js" as="script"><link rel="preload" href="/assets/js/25.58e5e2bb.js" as="script"><link rel="prefetch" href="/assets/js/10.36ab4607.js"><link rel="prefetch" href="/assets/js/100.9b17f904.js"><link rel="prefetch" href="/assets/js/101.0701842d.js"><link rel="prefetch" href="/assets/js/102.c869f055.js"><link rel="prefetch" href="/assets/js/103.474c3367.js"><link rel="prefetch" href="/assets/js/104.0c14e8c6.js"><link rel="prefetch" href="/assets/js/105.58caf12e.js"><link rel="prefetch" href="/assets/js/106.2bafbbbd.js"><link rel="prefetch" href="/assets/js/107.469e7b72.js"><link rel="prefetch" href="/assets/js/108.008134a4.js"><link rel="prefetch" href="/assets/js/109.257f2bdb.js"><link rel="prefetch" href="/assets/js/11.9d26e9af.js"><link rel="prefetch" href="/assets/js/110.ac94b6b0.js"><link rel="prefetch" href="/assets/js/111.e8708105.js"><link rel="prefetch" href="/assets/js/112.11fb3870.js"><link rel="prefetch" href="/assets/js/113.714875ed.js"><link rel="prefetch" href="/assets/js/114.28657052.js"><link rel="prefetch" href="/assets/js/115.cac6fd86.js"><link rel="prefetch" href="/assets/js/116.895cf8b7.js"><link rel="prefetch" href="/assets/js/117.739c4331.js"><link rel="prefetch" href="/assets/js/118.47d35ca1.js"><link rel="prefetch" href="/assets/js/119.7a3ac327.js"><link rel="prefetch" href="/assets/js/12.0b61f8e9.js"><link rel="prefetch" href="/assets/js/120.1dc19b09.js"><link rel="prefetch" href="/assets/js/121.224e3acd.js"><link rel="prefetch" href="/assets/js/122.52b1d22f.js"><link rel="prefetch" href="/assets/js/123.9add7043.js"><link rel="prefetch" href="/assets/js/124.2f074763.js"><link rel="prefetch" href="/assets/js/125.e8fa72d0.js"><link rel="prefetch" href="/assets/js/126.8123b385.js"><link rel="prefetch" href="/assets/js/127.3b37190f.js"><link rel="prefetch" href="/assets/js/128.da5f0d60.js"><link rel="prefetch" href="/assets/js/129.d4cb88fe.js"><link rel="prefetch" href="/assets/js/13.152b21ae.js"><link rel="prefetch" href="/assets/js/130.80d7ac86.js"><link rel="prefetch" href="/assets/js/131.a776f8de.js"><link rel="prefetch" href="/assets/js/132.6d555790.js"><link rel="prefetch" href="/assets/js/133.f7f92756.js"><link rel="prefetch" href="/assets/js/134.eb16b986.js"><link rel="prefetch" href="/assets/js/135.e6c5df80.js"><link rel="prefetch" href="/assets/js/136.a78bf4ca.js"><link rel="prefetch" href="/assets/js/137.08eb35a3.js"><link rel="prefetch" href="/assets/js/138.a23633e7.js"><link rel="prefetch" href="/assets/js/139.34a44cc7.js"><link rel="prefetch" href="/assets/js/14.601864c0.js"><link rel="prefetch" href="/assets/js/140.37362879.js"><link rel="prefetch" href="/assets/js/141.5490f63d.js"><link rel="prefetch" href="/assets/js/142.82b1708b.js"><link rel="prefetch" href="/assets/js/143.1f7fa930.js"><link rel="prefetch" href="/assets/js/144.2128c91e.js"><link rel="prefetch" href="/assets/js/145.064daafd.js"><link rel="prefetch" href="/assets/js/146.c28e9659.js"><link rel="prefetch" href="/assets/js/147.1fc1b1ce.js"><link rel="prefetch" href="/assets/js/15.1ca2d588.js"><link rel="prefetch" href="/assets/js/16.f4f9fc10.js"><link rel="prefetch" href="/assets/js/17.c0c7e874.js"><link rel="prefetch" href="/assets/js/18.1dcc6d96.js"><link rel="prefetch" href="/assets/js/19.eb1d2ccc.js"><link rel="prefetch" href="/assets/js/20.e0b38ec4.js"><link rel="prefetch" href="/assets/js/21.78e23c64.js"><link rel="prefetch" href="/assets/js/22.2aa7a141.js"><link rel="prefetch" href="/assets/js/23.44c58c4c.js"><link rel="prefetch" href="/assets/js/24.0840f4e5.js"><link rel="prefetch" href="/assets/js/26.117af3de.js"><link rel="prefetch" href="/assets/js/27.21f17c05.js"><link rel="prefetch" href="/assets/js/28.c1a21400.js"><link rel="prefetch" href="/assets/js/29.73cf9cfe.js"><link rel="prefetch" href="/assets/js/3.ce969d4f.js"><link rel="prefetch" href="/assets/js/30.89a7dd5d.js"><link rel="prefetch" href="/assets/js/31.d17540eb.js"><link rel="prefetch" href="/assets/js/32.58394ca4.js"><link rel="prefetch" href="/assets/js/33.4bd425cb.js"><link rel="prefetch" href="/assets/js/34.9c92017a.js"><link rel="prefetch" href="/assets/js/35.3c149013.js"><link rel="prefetch" href="/assets/js/36.867a8cde.js"><link rel="prefetch" href="/assets/js/37.7b5bad62.js"><link rel="prefetch" href="/assets/js/38.008bb40d.js"><link rel="prefetch" href="/assets/js/39.6b2a0153.js"><link rel="prefetch" href="/assets/js/4.b8125ad6.js"><link rel="prefetch" href="/assets/js/40.7bb9c709.js"><link rel="prefetch" href="/assets/js/41.17ac3941.js"><link rel="prefetch" href="/assets/js/42.d993a8f7.js"><link rel="prefetch" href="/assets/js/43.17017893.js"><link rel="prefetch" href="/assets/js/44.5aeb8841.js"><link rel="prefetch" href="/assets/js/45.f96b17d1.js"><link rel="prefetch" href="/assets/js/46.7be334fe.js"><link rel="prefetch" href="/assets/js/47.ac4c7dc5.js"><link rel="prefetch" href="/assets/js/48.35994a43.js"><link rel="prefetch" href="/assets/js/49.345a6aed.js"><link rel="prefetch" href="/assets/js/5.2d50631a.js"><link rel="prefetch" href="/assets/js/50.8ea6eace.js"><link rel="prefetch" href="/assets/js/51.a26f2640.js"><link rel="prefetch" href="/assets/js/52.58d1f5a0.js"><link rel="prefetch" href="/assets/js/53.fc8989a8.js"><link rel="prefetch" href="/assets/js/54.07b7f995.js"><link rel="prefetch" href="/assets/js/55.6dccc598.js"><link rel="prefetch" href="/assets/js/56.fdc05319.js"><link rel="prefetch" href="/assets/js/57.bc260f10.js"><link rel="prefetch" href="/assets/js/58.4e0a8a9f.js"><link rel="prefetch" href="/assets/js/59.76b62f78.js"><link rel="prefetch" href="/assets/js/6.674e2ad9.js"><link rel="prefetch" href="/assets/js/60.d4c23abe.js"><link rel="prefetch" href="/assets/js/61.165c06a7.js"><link rel="prefetch" href="/assets/js/62.c2bcadc1.js"><link rel="prefetch" href="/assets/js/63.7110d0c6.js"><link rel="prefetch" href="/assets/js/64.a6a7e5c3.js"><link rel="prefetch" href="/assets/js/65.94e5c997.js"><link rel="prefetch" href="/assets/js/66.ed8836e8.js"><link rel="prefetch" href="/assets/js/67.c3c3e0c9.js"><link rel="prefetch" href="/assets/js/68.bf1b8084.js"><link rel="prefetch" href="/assets/js/69.9f016d63.js"><link rel="prefetch" href="/assets/js/7.f1dd9a86.js"><link rel="prefetch" href="/assets/js/70.7e0bc09c.js"><link rel="prefetch" href="/assets/js/71.3ae402eb.js"><link rel="prefetch" href="/assets/js/72.7879c336.js"><link rel="prefetch" href="/assets/js/73.def7a37e.js"><link rel="prefetch" href="/assets/js/74.3b9f954e.js"><link rel="prefetch" href="/assets/js/75.2e9e2b27.js"><link rel="prefetch" href="/assets/js/76.cac7a9f9.js"><link rel="prefetch" href="/assets/js/77.5a3fef85.js"><link rel="prefetch" href="/assets/js/78.0fb59069.js"><link rel="prefetch" href="/assets/js/79.85c45650.js"><link rel="prefetch" href="/assets/js/80.78584108.js"><link rel="prefetch" href="/assets/js/81.fe08dddf.js"><link rel="prefetch" href="/assets/js/82.c35a31a3.js"><link rel="prefetch" href="/assets/js/83.a59c1610.js"><link rel="prefetch" href="/assets/js/84.6d1b3162.js"><link rel="prefetch" href="/assets/js/85.9262305f.js"><link rel="prefetch" href="/assets/js/86.37b2f16a.js"><link rel="prefetch" href="/assets/js/87.2184483e.js"><link rel="prefetch" href="/assets/js/88.09b238a4.js"><link rel="prefetch" href="/assets/js/89.44a81250.js"><link rel="prefetch" href="/assets/js/90.0014ee22.js"><link rel="prefetch" href="/assets/js/91.b1982ed2.js"><link rel="prefetch" href="/assets/js/92.5b95dd54.js"><link rel="prefetch" href="/assets/js/93.6cef1ff1.js"><link rel="prefetch" href="/assets/js/94.4ceecca3.js"><link rel="prefetch" href="/assets/js/95.c6bc53cb.js"><link rel="prefetch" href="/assets/js/96.525108e9.js"><link rel="prefetch" href="/assets/js/97.4298d30d.js"><link rel="prefetch" href="/assets/js/98.352bf642.js"><link rel="prefetch" href="/assets/js/99.31a22d5b.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.271bc088.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4c261fea.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">NightWatch</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/Basic/" class="nav-link">
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/front-end/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/front-end/前端工程化/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/性能优化/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/数据格式/" class="nav-link">
  数据格式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端开发" class="dropdown-title"><span class="title">后端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端开发" class="mobile-dropdown-title"><span class="title">后端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back-end/environment/" class="nav-link">
  环境配置
</a></li><li class="dropdown-item"><!----> <a href="/back-end/mysql/" class="nav-link">
  MySQL数据库
</a></li><li class="dropdown-item"><!----> <a href="/back-end/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/back-end/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/back-end/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/back-end/docker/" class="nav-link router-link-active">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/linux/" class="nav-link">
  Linux操作系统
</a></li><li class="dropdown-item"><!----> <a href="/computer/windows/" class="nav-link">
  Windows操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIS开发" class="dropdown-title"><span class="title">GIS开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIS开发" class="mobile-dropdown-title"><span class="title">GIS开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gis/GIS原理/" class="nav-link">
  GIS原理
</a></li><li class="dropdown-item"><!----> <a href="/gis/WebGIS/" class="nav-link">
  WebGIS开发
</a></li><li class="dropdown-item"><!----> <a href="/gis/地图学/" class="nav-link">
  地图学
</a></li><li class="dropdown-item"><!----> <a href="/gis/数据库/" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/gis/tools/" class="nav-link">
  GIS工具
</a></li></ul></div></div><div class="nav-item"><a href="/rong/" class="nav-link">
  Rong
</a></div><div class="nav-item"><a href="/others/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/test/1.html" class="nav-link">
  测试
</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">
  首页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端开发" class="dropdown-title"><span class="title">前端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="前端开发" class="mobile-dropdown-title"><span class="title">前端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/Basic/" class="nav-link">
  前端基础
</a></li><li class="dropdown-item"><!----> <a href="/front-end/React/" class="nav-link">
  React
</a></li><li class="dropdown-item"><!----> <a href="/front-end/Vue/" class="nav-link">
  Vue
</a></li><li class="dropdown-item"><!----> <a href="/front-end/前端工程化/" class="nav-link">
  前端工程化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/性能优化/" class="nav-link">
  性能优化
</a></li><li class="dropdown-item"><!----> <a href="/front-end/数据格式/" class="nav-link">
  数据格式
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="后端开发" class="dropdown-title"><span class="title">后端开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="后端开发" class="mobile-dropdown-title"><span class="title">后端开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/back-end/environment/" class="nav-link">
  环境配置
</a></li><li class="dropdown-item"><!----> <a href="/back-end/mysql/" class="nav-link">
  MySQL数据库
</a></li><li class="dropdown-item"><!----> <a href="/back-end/python/" class="nav-link">
  Python
</a></li><li class="dropdown-item"><!----> <a href="/back-end/springboot/" class="nav-link">
  SpringBoot
</a></li><li class="dropdown-item"><!----> <a href="/back-end/java/" class="nav-link">
  Java
</a></li><li class="dropdown-item"><!----> <a href="/back-end/docker/" class="nav-link router-link-active">
  Docker
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><span class="title">计算机基础</span> <span class="arrow down"></span></button> <button type="button" aria-label="计算机基础" class="mobile-dropdown-title"><span class="title">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/computer/linux/" class="nav-link">
  Linux操作系统
</a></li><li class="dropdown-item"><!----> <a href="/computer/windows/" class="nav-link">
  Windows操作系统
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="GIS开发" class="dropdown-title"><span class="title">GIS开发</span> <span class="arrow down"></span></button> <button type="button" aria-label="GIS开发" class="mobile-dropdown-title"><span class="title">GIS开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/gis/GIS原理/" class="nav-link">
  GIS原理
</a></li><li class="dropdown-item"><!----> <a href="/gis/WebGIS/" class="nav-link">
  WebGIS开发
</a></li><li class="dropdown-item"><!----> <a href="/gis/地图学/" class="nav-link">
  地图学
</a></li><li class="dropdown-item"><!----> <a href="/gis/数据库/" class="nav-link">
  数据库
</a></li><li class="dropdown-item"><!----> <a href="/gis/tools/" class="nav-link">
  GIS工具
</a></li></ul></div></div><div class="nav-item"><a href="/rong/" class="nav-link">
  Rong
</a></div><div class="nav-item"><a href="/others/" class="nav-link">
  其他
</a></div><div class="nav-item"><a href="/test/1.html" class="nav-link">
  测试
</a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Docker</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/back-end/docker/" aria-current="page" class="sidebar-link">♥Docker♥</a></li><li><a href="/back-end/docker/DockerFile的使用.html" class="sidebar-link">DockerFile的使用</a></li><li><a href="/back-end/docker/Docker常用命令.html" class="sidebar-link">Docker常用命令</a></li><li><a href="/back-end/docker/Docker的容器、镜像与数据卷.html" class="active sidebar-link">Docker的容器、镜像与数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#docker概述" class="sidebar-link">Docker概述</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#docker为什么出现" class="sidebar-link">Docker为什么出现</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#docker能干嘛" class="sidebar-link">Docker能干嘛</a></li></ul></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#docker安装" class="sidebar-link">Docker安装</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#centos7" class="sidebar-link">Centos7</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#腾讯云镜像加速" class="sidebar-link">腾讯云镜像加速</a></li></ul></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#docker镜像" class="sidebar-link">Docker镜像</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#镜像是什么" class="sidebar-link">镜像是什么</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#镜像加载原理" class="sidebar-link">镜像加载原理</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#分层理解" class="sidebar-link">分层理解</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#镜像commit" class="sidebar-link">镜像commit</a></li></ul></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#容器数据卷" class="sidebar-link">容器数据卷</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#什么是容器数据卷" class="sidebar-link">什么是容器数据卷</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#使用数据卷" class="sidebar-link">使用数据卷</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#实战-安装mysql" class="sidebar-link">实战：安装MySQL</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#具名和匿名挂载" class="sidebar-link">具名和匿名挂载</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#初识dockerfile" class="sidebar-link">初识DockerFile</a></li><li class="sidebar-sub-header"><a href="/back-end/docker/Docker的容器、镜像与数据卷.html#数据卷容器" class="sidebar-link">数据卷容器</a></li></ul></li></ul></li><li><a href="/back-end/docker/Docker进阶.html" class="sidebar-link">Docker进阶</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="docker的容器、镜像与数据卷"><a href="#docker的容器、镜像与数据卷" class="header-anchor">#</a> Docker的容器、镜像与数据卷</h1> <h2 id="docker概述"><a href="#docker概述" class="header-anchor">#</a> Docker概述</h2> <h3 id="docker为什么出现"><a href="#docker为什么出现" class="header-anchor">#</a> Docker为什么出现</h3> <p>一款产品从应用到上线，需要配置负复杂的运行环境，需要考虑不同版本环境的兼容，而且不能跨平台，移植到另一台服务器又得重新配置一遍。</p> <p>Docker通过镜像将应用程序所需的系统环境进行打包，解决环境配置的诸多问题。</p> <p>Docker将应用程序运行在容器上，而容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。“一次封装、到处运行”。</p> <p>在容器技术出现之前，业界网红是<strong>虚拟机</strong>。虚拟机的代表，是<strong>VMWare</strong>和<strong>OpenStack</strong>。虚拟机技术是虚拟出一套硬件之后，在其上运行一个完整的操作系统，在操作系统上再运行所需应用。</p> <p><strong>Docker和虚拟机的区别？</strong></p> <ul><li>虚拟机占用资源多，冗余步骤多，启动慢</li> <li>容器内的应用直接运行于宿主机内核，容器没有自己的内核，也没有硬件虚拟，因此更为轻便。</li> <li>每个容器相互隔离，每个容器有自己的文件系统，容器间进程不会互相影响，能区分计算资源。</li></ul> <h3 id="docker能干嘛"><a href="#docker能干嘛" class="header-anchor">#</a> Docker能干嘛</h3> <ul><li>更快的应用交付和部署</li> <li>更便捷的升级和扩容</li> <li>更简单的系统运维</li> <li>更高效的计算资源利用</li></ul> <h2 id="docker安装"><a href="#docker安装" class="header-anchor">#</a> Docker安装</h2> <h3 id="centos7"><a href="#centos7" class="header-anchor">#</a> Centos7</h3> <p>这里使用了腾讯云个人用户1个月试用的云服务器</p> <p><a href="https://docs.docker.com/guides/" target="_blank" rel="noopener noreferrer">官网地址<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <p>安装：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># step 1: 安装必要的一些系统工具  </span>
<span class="token function">sudo</span> yum <span class="token function">install</span> <span class="token parameter variable">-y</span> yum-utils device-mapper-persistent-data lvm2
<span class="token comment"># Step 2: 添加添加阿里云镜像</span>
<span class="token function">sudo</span> yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo
<span class="token comment"># Step 3</span>
<span class="token function">sudo</span> <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s+download.docker.com+mirrors.aliyun.com/docker-ce+'</span> /etc/yum.repos.d/docker-ce.repo
<span class="token comment"># Step 4: 更新并安装Docker-CE</span>
<span class="token function">sudo</span> yum makecache fast  <span class="token comment"># 生成缓存</span>
<span class="token function">sudo</span> yum <span class="token parameter variable">-y</span> <span class="token function">install</span> docker-ce
<span class="token comment"># Step 5: 开启Docker服务</span>
<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">docker</span> start
<span class="token comment"># Step 6: 检查是否安装成功</span>
<span class="token function">docker</span> version
</code></pre></div><p>卸载：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> yum remove docker-ce
<span class="token function">sudo</span> <span class="token function">rm</span> <span class="token parameter variable">-rf</span> /var/lib/docker
</code></pre></div><blockquote><p>说明：</p> <ul><li>yum-utils管理yum配置和存储库,device-mapper-persistent-data用于逻辑卷管理，lvm2用于动态调整磁盘分区大小</li></ul></blockquote> <h3 id="腾讯云镜像加速"><a href="#腾讯云镜像加速" class="header-anchor">#</a> 腾讯云镜像加速</h3> <p><a href="https://cloud.tencent.com/document/product/1141/63910" target="_blank" rel="noopener noreferrer">容器镜像服务个人版使用说明<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> login ccr.ccs.tencentyun.com <span class="token parameter variable">--username</span><span class="token operator">=</span>xxxxxxxxxxx
</code></pre></div><p>执行以下命令，打开 <code>/etc/docker/daemon.json</code> 配置文件。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">vim</span> /etc/docker/daemon.json
</code></pre></div><p>按 <strong>i</strong> 切换至编辑模式，添加以下内容，并保存。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token punctuation">{</span>
   <span class="token string">&quot;registry-mirrors&quot;</span><span class="token builtin class-name">:</span> <span class="token punctuation">[</span>
   <span class="token string">&quot;https://mirror.ccs.tencentyun.com&quot;</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre></div><p>执行以下命令，重启 Docker 即可。示例命令以 CentOS 7 为例。</p> <div class="language-bash extra-class"><pre class="language-bash"><code><span class="token function">sudo</span> systemctl restart <span class="token function">docker</span>
</code></pre></div><p>查看镜像仓库地址</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">sudo</span> <span class="token function">docker</span> info
</code></pre></div><h2 id="docker镜像"><a href="#docker镜像" class="header-anchor">#</a> Docker镜像</h2> <h3 id="镜像是什么"><a href="#镜像是什么" class="header-anchor">#</a> 镜像是什么</h3> <p>镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。</p> <h3 id="镜像加载原理"><a href="#镜像加载原理" class="header-anchor">#</a> 镜像加载原理</h3> <p>UnionFS（联合文件系统）：</p> <ul><li>Union文件系统（UnionFS）是一种<strong>分层、轻量级并且高性能</strong>的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual ﬁlesystem)。</li> <li>Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。</li> <li>特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录.</li></ul> <p>Docker镜像加载原理：</p> <ul><li>docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统<code>UnionFS</code>。</li> <li><code>bootfs</code>(boot ﬁle system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux启动时，bootfs被加载到内存，提供启动内核所需的文件。启动完成后，系统会从bootfs切换到rootfs，并卸载bootfs。</li> <li><code>rootfs</code> (root ﬁle system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。</li></ul> <p>平时安装虚拟机和centos都是好几个G，为什么Docker这里只需要200M？</p> <ul><li>对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就好了。对于不同的linux发行版，bootfs基本是一致的，rootfs会有差别，因此不同的发行版可以共用bootfs。</li></ul> <blockquote><p>什么是bootfs和rootfs?</p> <ul><li><code>bootfs</code> Linux 操作系统启动时最早加载的文件系统，通常包含内核映像（Kernel Image）和初始的 RAM 文件系统。</li> <li><code>rootfs</code> 是 Linux 系统的根文件系统，包含了操作系统运行所需的所有文件。它包括 <code>/bin</code>、<code>/lib</code>、<code>/etc</code>、<code>/dev</code> 等目录，以及应用程序和用户数据。</li></ul></blockquote> <h3 id="分层理解"><a href="#分层理解" class="header-anchor">#</a> 分层理解</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker pull redis</span>
Using default tag: latest
latest: Pulling from library/redis
e4fff0779e6d: Already exists  <span class="token comment"># 重复的层不会再下载</span>
d1dde3db2ec5: Pull complete
1d321a003dde: Pull complete
d65aedb2f012: Pull complete
4018f93716a2: Pull complete
b0967b02e8cf: Pull complete
4f4fb700ef54: Pull complete
d288b86f5d06: Pull complete
Digest: sha256:878983f8f5045b28384fc300268cec62bca3b14d5e1a448bec21f28cfcc7bf78
Status: Downloaded newer image <span class="token keyword">for</span> redis:latest
docker.io/library/redis:latest
</code></pre></div><blockquote><p><strong>思考：为什么Docker镜像要采用这种分层的结构呢？</strong>
最大的好处，我觉得莫过于是资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机
只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服
务了，而且镜像的每一层都可以被共享。</p></blockquote> <p>所有的 Docker 镜像都起始于一个<strong>基础镜像层</strong>，当进行修改或增加新的内容时，就会在当前镜像层之
上，创建新的镜像层。</p> <p><img src="https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E5%88%86%E5%B1%82.png" alt="镜像分层"></p> <p>Docker 通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统
一的文件系统。</p> <p><img src="https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E7%9A%84%E4%BF%AE%E6%94%B9%E5%B1%82.png" alt="镜像的修改层"></p> <p>这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新
镜像层添加到镜像当中。</p> <p>存储引擎：</p> <ul><li>Linux 上可用的存储引擎有 AUFS、Overlay2、Device Mapper、Btrfs 以及 ZFS。顾名思义，每种存储引擎都基于 Linux 中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。</li> <li>Windows 上仅支持 windowsﬁlter 一种存储引擎，该引擎基于 NTFS 文件系统之上实现了分层。</li></ul> <p>下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。</p> <p><img src="https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E7%BB%9F%E4%B8%80%E8%A7%86%E5%9B%BE.png" alt="镜像统一视图"></p> <blockquote><p>Docker镜像都是只读的，当容器启动时，一个新的<strong>可写层</strong>被加载到镜像的顶部！</p> <p>这一层就是我们的容器层，容器层之下都叫镜像层。</p></blockquote> <h3 id="镜像commit"><a href="#镜像commit" class="header-anchor">#</a> 镜像commit</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token function">docker</span> commit 提交容器成为一个新的本地镜像

<span class="token comment"># 命令和git原理类似</span>
<span class="token function">docker</span> commit <span class="token parameter variable">-m</span><span class="token operator">=</span><span class="token string">&quot;描述信息&quot;</span> <span class="token parameter variable">-a</span><span class="token operator">=</span><span class="token string">&quot;作者&quot;</span> 容器id 目标镜像名：<span class="token punctuation">[</span>TAG<span class="token punctuation">]</span>
</code></pre></div><p>实战测试：官方的tomcat的webapps目录下是空的，我们可以自己制作一个镜像，让它包含初始内容</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 启动默认的tomcat</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> tomcat01 <span class="token parameter variable">-p</span> <span class="token number">4396</span>:8080 tomcat:9.0

<span class="token comment"># 进入容器</span>
<span class="token function">docker</span> <span class="token builtin class-name">exec</span> <span class="token parameter variable">-it</span> tomcat01 /bin/bash

<span class="token comment"># 复制webapps</span>
<span class="token function">cp</span> <span class="token parameter variable">-r</span> webapps.dist/* webapps

<span class="token comment"># 退出</span>
<span class="token builtin class-name">exit</span>

<span class="token comment"># 重启tomcat</span>
<span class="token function">docker</span> restart tomcat01

<span class="token comment"># commit 提交镜像</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker commit -m=&quot;add webapps&quot; -a=&quot;huyadish&quot; 6525ee04867f tomcat02:1.0</span>
sha256:eea1dcc18db2ebe7b6d88abac28e793d8df457deb76fb99473b97053f28d66cb

<span class="token comment"># 查看tomcat02比tomcat 大了一点</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY            TAG       IMAGE ID       CREATED          SIZE
tomcat02              <span class="token number">1.0</span>       eea1dcc18db2   <span class="token number">26</span> seconds ago   468MB
tomcat                <span class="token number">9.0</span>       90717097970a   <span class="token number">12</span> days ago      463MB

<span class="token comment"># 启动新的tomcat</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker run -d -p 4396:8080 tomcat02:1.0</span>
</code></pre></div><p>学习方式思考：先简单理解概念，再动手实践，最后实践和理论结合一次性搞定这个知识</p> <p>到这里才算入门docker</p> <h2 id="容器数据卷"><a href="#容器数据卷" class="header-anchor">#</a> 容器数据卷</h2> <h3 id="什么是容器数据卷"><a href="#什么是容器数据卷" class="header-anchor">#</a> 什么是容器数据卷</h3> <p>如果数据都在容器中，那么删除容器数据就会丢失！需求：<strong>数据可以持久化</strong></p> <p>MySQL，容器删了同时也删除了数据库！需求：<strong>Mysql数据可以存储在本地！</strong></p> <p>卷技术可以通过目录的挂载，将容器内目录，挂载到Linux上。多个容器之间数据可以共享！</p> <h3 id="使用数据卷"><a href="#使用数据卷" class="header-anchor">#</a> 使用数据卷</h3> <ul><li>使用命令来挂载</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># docker run -v 宿主机目录:容器目录</span>
<span class="token function">docker</span> run <span class="token parameter variable">-it</span> <span class="token parameter variable">-v</span> /home/test:/home centos /bin/bash

<span class="token comment"># 启动后通过docker inspect 查看容器详细信息</span>
<span class="token function">docker</span> inspect e6512dddaf3f
</code></pre></div><p>执行之后宿主机的<code>/home/test</code>目录会和容器的<code>/home</code>目录，双向同步</p> <p>即使容器关了，修改宿主机目录内容，重新打开容器，对应目录内容同样会更新</p> <h3 id="实战-安装mysql"><a href="#实战-安装mysql" class="header-anchor">#</a> 实战：安装MySQL</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 获取镜像</span>
<span class="token punctuation">[</span>root@VM-20-7-centos /<span class="token punctuation">]</span><span class="token comment"># docker pull mysql:8.0</span>

<span class="token comment"># 启动mysql</span>
<span class="token parameter variable">-d</span> 后台运行
<span class="token parameter variable">-p</span> 端口映射
<span class="token parameter variable">-v</span> 目录挂载  宿主机目录:容器目录  可以使用多个 <span class="token parameter variable">-v</span>
<span class="token parameter variable">-e</span> 设置环境
<span class="token punctuation">[</span>root@VM-20-7-centos /<span class="token punctuation">]</span><span class="token comment"># docker run -d -p 3306:3306 -v /home/mysql/conf:/etc/mysql/conf.d -v /home/mysql/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=123456 --name mysql8.0 mysql:8.0</span>

<span class="token comment"># 宿主机产生了对应目录</span>
<span class="token punctuation">[</span>root@VM-20-7-centos /<span class="token punctuation">]</span><span class="token comment"># ls /home/mysql</span>
conf  data

<span class="token comment"># 启动成功后开启3306端口，并通过远程navicat连接</span>
<span class="token punctuation">[</span>root@VM-20-7-centos /<span class="token punctuation">]</span><span class="token comment"># ufw allow 3306</span>

<span class="token comment"># 查看宿主机目录</span>
<span class="token punctuation">[</span>root@VM-20-7-centos /<span class="token punctuation">]</span><span class="token comment"># cd /home/mysql/data</span>
<span class="token punctuation">[</span>root@VM-20-7-centos data<span class="token punctuation">]</span><span class="token comment"># ls</span>
auto.cnf       binlog.index  client-cert.pem    <span class="token comment">#ib_16384_1.dblwr  ibtmp1        mysql       performance_schema  server-cert.pem  undo_001</span>
binlog.000001  ca-key.pem    client-key.pem     ib_buffer_pool     <span class="token comment">#innodb_redo  mysql.ibd   private_key.pem     server-key.pem   undo_002</span>
binlog.000002  ca.pem        <span class="token comment">#ib_16384_0.dblwr  ibdata1            #innodb_temp  mysql.sock  public_key.pem      sys</span>
<span class="token punctuation">[</span>root@VM-20-7-centos data<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># navicat中创建test数据库</span>

<span class="token comment"># 再次查看 发现多了test数据库</span>
<span class="token punctuation">[</span>root@VM-20-7-centos data<span class="token punctuation">]</span><span class="token comment"># ls</span>
auto.cnf       binlog.index  client-cert.pem    <span class="token comment">#ib_16384_1.dblwr  ibtmp1        mysql       performance_schema  server-cert.pem  test</span>
binlog.000001  ca-key.pem    client-key.pem     ib_buffer_pool     <span class="token comment">#innodb_redo  mysql.ibd   private_key.pem     server-key.pem   undo_001</span>
binlog.000002  ca.pem        <span class="token comment">#ib_16384_0.dblwr  ibdata1            #innodb_temp  mysql.sock  public_key.pem      sys              undo_002</span>

</code></pre></div><p>假设将容器删除，本地的数据不会丢失</p> <h3 id="具名和匿名挂载"><a href="#具名和匿名挂载" class="header-anchor">#</a> 具名和匿名挂载</h3> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 匿名挂载  -v 容器内路径</span>
<span class="token function">docker</span> run <span class="token parameter variable">-d</span> <span class="token parameter variable">-P</span> <span class="token parameter variable">--name</span> nginx01 <span class="token parameter variable">-v</span> /etc/nginx nginx

<span class="token comment"># 查看所有的卷的情况</span>
<span class="token punctuation">[</span>root@VM-20-7-centos data<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="token builtin class-name">local</span>     2da55574a37b01a128232cf449171dc6c24b8467a3229c87a3f629e8e10764ab
<span class="token builtin class-name">local</span>     615a8c9be191c64c440449cb995769c2b26118a523e572dc2e7eecdc7f85dde9

<span class="token comment"># 具名挂载 -v 卷名:容器内路径</span>
root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker run -P -d --name nginx02 -v volume01:/etc/nginx nginx</span>
67726065cc8668f6c7f067955bbd14ba78908794538cfff23c452f79b3cc529c
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment">#</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># 可以看到我们命名的卷volume01</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker volume ls</span>
DRIVER    VOLUME NAME
<span class="token builtin class-name">local</span>     2da55574a37b01a128232cf449171dc6c24b8467a3229c87a3f629e8e10764ab
<span class="token builtin class-name">local</span>     615a8c9be191c64c440449cb995769c2b26118a523e572dc2e7eecdc7f85dde9
<span class="token builtin class-name">local</span>     volume01

<span class="token comment"># 查看卷的位置 docker volume inspect 卷名</span>
<span class="token punctuation">[</span>root@VM-20-7-centos home<span class="token punctuation">]</span><span class="token comment"># docker volume inspect volume01</span>
<span class="token punctuation">[</span>
    <span class="token punctuation">{</span>
        <span class="token string">&quot;CreatedAt&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;2024-08-19T15:12:34+08:00&quot;</span>,
        <span class="token string">&quot;Driver&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>,
        <span class="token string">&quot;Labels&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;Mountpoint&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;/var/lib/docker/volumes/volume01/_data&quot;</span>,
        <span class="token string">&quot;Name&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;volume01&quot;</span>,
        <span class="token string">&quot;Options&quot;</span><span class="token builtin class-name">:</span> null,
        <span class="token string">&quot;Scope&quot;</span><span class="token builtin class-name">:</span> <span class="token string">&quot;local&quot;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">]</span>
</code></pre></div><p>所有docker容器内的卷，没有指定目录的情况下都是在宿主机的<code>/var/lib/docker/volumes/xxxxx/_data</code></p> <p>通过具名挂载可以方便得找到卷，大多数情况使用<code>具名挂载</code></p> <p>拓展：</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 通过 -v 容器内路径:ro rw 改变读写权限</span>
<span class="token comment"># ro readonly 只读</span>
<span class="token comment"># rw readwrite 读写，默认值</span>

<span class="token comment"># 设置了ro 容器内部就不能改变卷了，只能通过宿主机操作</span>
<span class="token function">docker</span> run <span class="token parameter variable">-P</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> volume01:/etc/nginx:ro nginx
<span class="token function">docker</span> run <span class="token parameter variable">-P</span> <span class="token parameter variable">-d</span> <span class="token parameter variable">--name</span> nginx02 <span class="token parameter variable">-v</span> volume01:/etc/nginx:rw nginx
</code></pre></div><h3 id="初识dockerfile"><a href="#初识dockerfile" class="header-anchor">#</a> 初识DockerFile</h3> <p>DockerFile就是用来构建Docker镜像的脚本文件。</p> <p>通过脚本可以生成镜像，镜像是分层的，脚本是一个个的命令，每个命令都是一层！</p> <ul><li>编辑dockerfile</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 创建一个dockerfile文件，明明建议dockerfile</span>

<span class="token comment"># 文件内容 指令(大写) 参数</span>
FROM centos

VOLUME <span class="token punctuation">[</span><span class="token string">&quot;volume01&quot;</span>,<span class="token string">&quot;volume02&quot;</span><span class="token punctuation">]</span>

CMD <span class="token builtin class-name">echo</span> <span class="token string">&quot;---end---&quot;</span>

CMD /bin/bash

<span class="token comment"># 这里的每个命令都是镜像的一层</span>
</code></pre></div><ul><li>使用dockerfile生成镜像</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@VM-20-7-centos docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker build -f dockerfile1  -t huyadish/centos:1.0 .</span>
<span class="token punctuation">[</span>+<span class="token punctuation">]</span> Building <span class="token number">0</span>.2s <span class="token punctuation">(</span><span class="token number">5</span>/5<span class="token punctuation">)</span> FINISHED                  
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>internal<span class="token punctuation">]</span> load build definition from dockerfile1
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> transferring dockerfile: 117B
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>internal<span class="token punctuation">]</span> load metadata <span class="token keyword">for</span> docker.io/library/centos:latest
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span>internal<span class="token punctuation">]</span> load .dockerignore
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> transferring context: 2B
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token punctuation">[</span><span class="token number">1</span>/1<span class="token punctuation">]</span> FROM docker.io/library/centos:latest
 <span class="token operator">=</span><span class="token operator">&gt;</span> exporting to image
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> exporting layers
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> writing image sha256:2771b5374df0a3d1fec5d343805c3291ee35f76cf68d2b731a421cb308eae93f
 <span class="token operator">=</span><span class="token operator">&gt;</span> <span class="token operator">=</span><span class="token operator">&gt;</span> naming to docker.io/huyadish/centos:1.0
 
 <span class="token comment"># 查看生成的镜像</span>
<span class="token punctuation">[</span>root@VM-20-7-centos docker-test-volume<span class="token punctuation">]</span><span class="token comment"># docker images</span>
REPOSITORY            TAG       IMAGE ID       CREATED         SIZE
centos                latest    5d0da3dc9764   <span class="token number">2</span> years ago     231MB
huyadish/centos       <span class="token number">1.0</span>       2771b5374df0   <span class="token number">2</span> years ago     231MB
</code></pre></div><ul><li>使用自定义镜像运行容器</li></ul> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token punctuation">[</span>root@VM-20-7-centos volumes<span class="token punctuation">]</span><span class="token comment"># docker run -it --name mycentos 2771b5374df0 /bin/bash</span>
<span class="token comment"># 可以看到容器已自动生成了数据卷 volume01  volume02</span>
<span class="token punctuation">[</span>root@6a9e1fc9d112 /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  volume01  volume02
<span class="token comment"># 创建文件</span>
<span class="token punctuation">[</span>root@6a9e1fc9d112 /<span class="token punctuation">]</span><span class="token comment"># cd volume01/</span>
<span class="token punctuation">[</span>root@6a9e1fc9d112 volume01<span class="token punctuation">]</span><span class="token comment"># touch container.txt</span>
<span class="token punctuation">[</span>root@6a9e1fc9d112 volume01<span class="token punctuation">]</span><span class="token comment"># ls</span>
container.txt
<span class="token comment"># 退出</span>
<span class="token punctuation">[</span>root@6a9e1fc9d112 volume01<span class="token punctuation">]</span><span class="token comment"># exit</span>
<span class="token builtin class-name">exit</span>

<span class="token comment"># 查看启动的容器</span>
<span class="token punctuation">[</span>root@VM-20-7-centos volumes<span class="token punctuation">]</span><span class="token comment"># docker ps -a</span>
CONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                     PORTS     NAMES
6a9e1fc9d112   2771b5374df0   <span class="token string">&quot;/bin/bash&quot;</span>   <span class="token number">8</span> minutes ago   Exited <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token number">6</span> minutes ago             mycentos
<span class="token comment"># 拖过容器ID查看 详细信息</span>
<span class="token punctuation">[</span>root@VM-20-7-centos volumes<span class="token punctuation">]</span><span class="token comment"># docker inspect 6a9e1fc9d112</span>

<span class="token comment"># 可以看到volume01 的在宿主机的地址 /var/lib/docker/volumes/b3aeb4aa984abf2b69288b41cd9ef90bc124e22d6af75561f1cb3ddcabdfef2f/_data</span>

<span class="token comment"># 进入数据卷默认路径</span>
<span class="token punctuation">[</span>root@VM-20-7-centos volumes<span class="token punctuation">]</span><span class="token comment"># cd /var/lib/docker/volumes/</span>

<span class="token comment"># 进入volume01 路径</span>
<span class="token punctuation">[</span>root@VM-20-7-centos volumes<span class="token punctuation">]</span><span class="token comment"># cd b3aeb4aa984abf2b69288b41cd9ef90bc124e22d6af75561f1cb3ddcabdfef2f/</span>
<span class="token punctuation">[</span>root@VM-20-7-centos b3aeb4aa984abf2b69288b41cd9ef90bc124e22d6af75561f1cb3ddcabdfef2f<span class="token punctuation">]</span><span class="token comment"># cd _data/</span>
<span class="token comment"># 可以看到创建的测试文件</span>
<span class="token punctuation">[</span>root@VM-20-7-centos _data<span class="token punctuation">]</span><span class="token comment"># ls</span>
container.txt
</code></pre></div><h3 id="数据卷容器"><a href="#数据卷容器" class="header-anchor">#</a> 数据卷容器</h3> <p>多个mysql 同步数据</p> <div class="language-shell extra-class"><pre class="language-shell"><code><span class="token comment"># 启动centos01</span>
<span class="token punctuation">[</span>root@VM-20-7-centos _data<span class="token punctuation">]</span><span class="token comment"># docker run -it --name centos01 huyadish/centos:1.0 /bin/bash</span>
<span class="token punctuation">[</span>root@2b8a31b8f8ee /<span class="token punctuation">]</span><span class="token comment">#</span>

<span class="token comment"># 启动centos02 通过--volumes-from 将数据卷绑定到centos01</span>
<span class="token punctuation">[</span>root@VM-20-7-centos _data<span class="token punctuation">]</span><span class="token comment"># docker run -it --name centos02 --volumes-from centos01  huyadish/centos:1.0 /bin/bash</span>

<span class="token comment"># 在外部查看运行状况</span>
<span class="token punctuation">[</span>root@VM-20-7-centos ~<span class="token punctuation">]</span><span class="token comment"># docker ps</span>
CONTAINER ID   IMAGE                 COMMAND                  CREATED              STATUS              PORTS     NAMES
2d381d6ee79c   huyadish/centos:1.0   <span class="token string">&quot;/bin/sh -c /bin/bash&quot;</span>   <span class="token number">34</span> seconds ago       Up <span class="token number">33</span> seconds                 centos02
2b8a31b8f8ee   huyadish/centos:1.0   <span class="token string">&quot;/bin/bash&quot;</span>              About a minute ago   Up About a minute             centos01

<span class="token comment"># 进入centos01</span>
<span class="token punctuation">[</span>root@VM-20-7-centos ~<span class="token punctuation">]</span><span class="token comment"># docker attach 2b8a31b8f8ee</span>
<span class="token punctuation">[</span>root@2b8a31b8f8ee /<span class="token punctuation">]</span><span class="token comment"># ls</span>
bin  dev  etc  home  lib  lib64  lost+found  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var  volume01  volume02
<span class="token punctuation">[</span>root@2b8a31b8f8ee /<span class="token punctuation">]</span><span class="token comment"># cd volume01</span>
<span class="token punctuation">[</span>root@2b8a31b8f8ee volume01<span class="token punctuation">]</span><span class="token comment"># ls</span>

<span class="token comment"># 创建测试文件</span>
<span class="token punctuation">[</span>root@2b8a31b8f8ee volume01<span class="token punctuation">]</span><span class="token comment"># touch rong.java</span>
<span class="token punctuation">[</span>root@2b8a31b8f8ee volume01<span class="token punctuation">]</span><span class="token comment"># ls</span>
rong.java

<span class="token comment"># 进入centos02</span>
<span class="token punctuation">[</span>root@2d381d6ee79c /<span class="token punctuation">]</span><span class="token comment"># cd volume01</span>
<span class="token punctuation">[</span>root@2d381d6ee79c volume01<span class="token punctuation">]</span><span class="token comment"># ls</span>
rong.java

</code></pre></div><p>因为centos01和centos02的数据卷对应宿主机的同一个位置</p> <p>centos01和centos02对宿主机的数据卷是共享拷贝机制，即使删除centos01，centos02的数据依然在</p></div> <footer class="page-edit"><!----> <div class="last-updated"><span class="prefix">Last Updated:</span> <span class="time">10/24/2025, 5:48:25 AM</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/back-end/docker/Docker常用命令.html" class="prev">
        Docker常用命令
      </a></span> <span class="next"><a href="/back-end/docker/Docker进阶.html">
        Docker进阶
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"><!----></div></div>
    <script src="/assets/js/app.5f3ce635.js" defer></script><script src="/assets/js/2.4829a41e.js" defer></script><script src="/assets/js/1.21e39df5.js" defer></script><script src="/assets/js/25.58e5e2bb.js" defer></script>
  </body>
</html>
