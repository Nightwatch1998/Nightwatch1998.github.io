(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{393:function(t,s,a){"use strict";a.r(s);var r=a(10),e=Object(r.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h2",{attrs:{id:"视频流介绍"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#视频流介绍"}},[t._v("#")]),t._v(" 视频流介绍")]),t._v(" "),s("h3",{attrs:{id:"三大直播协议"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#三大直播协议"}},[t._v("#")]),t._v(" 三大直播协议")]),t._v(" "),s("h4",{attrs:{id:"rtmp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rtmp"}},[t._v("#")]),t._v(" RTMP")]),t._v(" "),s("p",[t._v("RTMP（Real Time Message Protocol）由Adobe公司在"),s("strong",[t._v("2002年")]),t._v("提出的流媒体协议，"),s("strong",[t._v("未完全公开")]),t._v("。用于解决多路复用和分包的问题。一般传输的是"),s("strong",[t._v("flv、f4v")]),t._v("格式的流。一般在一个通道上传输命令和数据。")]),t._v(" "),s("p",[t._v("优势：")]),t._v(" "),s("ul",[s("li",[t._v("支持实时交互和低延迟")]),t._v(" "),s("li",[t._v("适用于需要实时交互和快速响应的应用场景，如"),s("strong",[t._v("虎牙、斗鱼等传统视频直播平台")])])]),t._v(" "),s("p",[t._v("劣势：")]),t._v(" "),s("ul",[s("li",[t._v("在移动设备上的支持不如其他协议广泛")]),t._v(" "),s("li",[t._v("对防火墙和代理的穿透性较差")])]),t._v(" "),s("h4",{attrs:{id:"http-flv"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#http-flv"}},[t._v("#")]),t._v(" HTTP-FLV")]),t._v(" "),s("p",[t._v("FLV用http服务器即可实现传统的 流媒体服务器的功能，flv文件体积小，视频质量好。但是要基于flash插件。")]),t._v(" "),s("p",[t._v("可使用"),s("strong",[t._v("flv.js")]),t._v("将flv视频流数据转码，最终传递给h5的video标签进行播放")]),t._v(" "),s("p",[t._v("在中国的视频直播行业得到广泛应用")]),t._v(" "),s("h4",{attrs:{id:"hls"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hls"}},[t._v("#")]),t._v(" HLS")]),t._v(" "),s("p",[t._v("HLS(Http Live Streaming) 是苹果公司"),s("strong",[t._v("2009年")]),t._v("提出，的基于HTTP的流媒体网络传输协议。专属内容包括两部分，一是m3u8描述文件，二是ts流媒体文件。")]),t._v(" "),s("p",[s("strong",[t._v("m3u8")]),t._v("文件是指UTF-8编码的m3u文件,m3u文件是记录了索引的纯文本文件，打开时，播放软件根据索引找到对应的音视频文件地址进行在线播放。二级索引中记录了ts文件的地址。")]),t._v(" "),s("p",[t._v("将不同速率的版本切片，信息保存在m3u列表文件中。")]),t._v(" "),s("p",[t._v("优势：")]),t._v(" "),s("ul",[s("li",[t._v("实现自适应码率和跨平台播放")]),t._v(" "),s("li",[t._v("广泛支持各种终端设备，适用于"),s("strong",[t._v("移动和苹果设备上在线视频点播、直播等")])]),t._v(" "),s("li",[t._v("在不同带宽的网络环境下实现较好的流畅播放效果")])]),t._v(" "),s("p",[t._v("劣势：")]),t._v(" "),s("ul",[s("li",[t._v("实时性差，延迟高，基本在10s+以上")]),t._v(" "),s("li",[t._v("不适用于实时互动场景")])]),t._v(" "),s("p",[s("strong",[t._v("三者对比")])]),t._v(" "),s("table",[s("thead",[s("tr",[s("th"),t._v(" "),s("th",[t._v("RTMP")]),t._v(" "),s("th",[t._v("HLS")]),t._v(" "),s("th",[t._v("HTTP-FLV")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("协议")]),t._v(" "),s("td",[t._v("TCP长连接")]),t._v(" "),s("td",[t._v("HTTP短连接")]),t._v(" "),s("td",[t._v("HTTP长连接")])]),t._v(" "),s("tr",[s("td",[t._v("原理")]),t._v(" "),s("td",[t._v("每个时刻收到数据立刻转发")]),t._v(" "),s("td",[t._v("集合一段时间的数据，生成ts切片文件，并更新m3u8索引")]),t._v(" "),s("td",[t._v("同RTMP，使用HTTP协议(80端口)")])]),t._v(" "),s("tr",[s("td",[t._v("延时")]),t._v(" "),s("td",[t._v("1-3s")]),t._v(" "),s("td",[t._v("5-20s")]),t._v(" "),s("td",[t._v("1-3s")])]),t._v(" "),s("tr",[s("td",[t._v("web支持")]),t._v(" "),s("td",[t._v("H5需要使用插件")]),t._v(" "),s("td",[t._v("支持H5")]),t._v(" "),s("td",[t._v("H5中需要使用插件")])]),t._v(" "),s("tr",[s("td",[t._v("其他")]),t._v(" "),s("td",[t._v("跨平台支持差，需要Flash支持")]),t._v(" "),s("td",[t._v("播放时需要多次请求，对于网络的质量要求高")]),t._v(" "),s("td",[t._v("需要Flash技术支持，不支持多音频流、多视频流、不便于seek")])])])]),t._v(" "),s("h3",{attrs:{id:"rtsp和rtp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rtsp和rtp"}},[t._v("#")]),t._v(" RTSP和RTP")]),t._v(" "),s("p",[t._v("RTSP（Real-Time Stream Protocol）由Real Networks和Netscape共同提出的流媒体协议。")]),t._v(" "),s("p",[t._v("RTSP在1998年提出，RTP在1996年提出。RTSP负责控制流媒体播放、暂停、停止等操作，RTP负责传输媒体数据。")]),t._v(" "),s("p",[t._v("一般传输的是"),s("strong",[t._v("ts、mp4")]),t._v("格式的流")]),t._v(" "),s("p",[t._v("优势：")]),t._v(" "),s("ul",[s("li",[t._v("较好的实时性和可靠性")]),t._v(" "),s("li",[t._v("适用于"),s("strong",[t._v("流媒体服务器、IP摄像头、视频监控系统")]),t._v("等实时传输场景")])]),t._v(" "),s("p",[t._v("劣势：")]),t._v(" "),s("ul",[s("li",[t._v("需要额外的流媒体服务器和客户端支持，配置和部署相对复杂")]),t._v(" "),s("li",[t._v("穿透防火墙和代理存在困难")])]),t._v(" "),s("h3",{attrs:{id:"dash"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dash"}},[t._v("#")]),t._v(" DASH")]),t._v(" "),s("p",[t._v("DASH（Dynamic Adaptive Streaming over HTTP）基于HTTP的动态自适应流媒体传输协议。"),s("strong",[t._v("在2011年提出")]),t._v("，也是将视频切片，通过HTTP传输，实现自适应码率和跨平台播放。")]),t._v(" "),s("p",[t._v("DASH支持自适应码率、跨平台播放和多种编码格式，广泛用于"),s("strong",[t._v("流媒体点播、直播和互联网电视等领域。")])]),t._v(" "),s("h3",{attrs:{id:"smooth-streaming"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#smooth-streaming"}},[t._v("#")]),t._v(" Smooth Streaming")]),t._v(" "),s("p",[t._v("由Microsoft开发的流媒体传输协议，适用于Windows和Xbox平台，具有自适应码率功能。")]),t._v(" "),s("h3",{attrs:{id:"webrtc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#webrtc"}},[t._v("#")]),t._v(" WebRTC")]),t._v(" "),s("p",[t._v("WebRTC（Web Real-Time Communication）由Google"),s("strong",[t._v("在2011年")]),t._v("提出。基于UDP协议，支持浏览器的点对点传输，适用于"),s("strong",[t._v("视频通话，视频会议、远程协作")]),t._v("等场景。")]),t._v(" "),s("h3",{attrs:{id:"未来发展方向"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#未来发展方向"}},[t._v("#")]),t._v(" 未来发展方向")]),t._v(" "),s("p",[t._v("基于HTTP的流媒体传输协议，如HLS和DASH")]),t._v(" "),s("ul",[s("li",[t._v("平台兼容性")]),t._v(" "),s("li",[t._v("自适应码率")]),t._v(" "),s("li",[t._v("强大的生态系统")]),t._v(" "),s("li",[t._v("支持新的技术和特性")])]),t._v(" "),s("h2",{attrs:{id:"相关概念"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#相关概念"}},[t._v("#")]),t._v(" 相关概念")]),t._v(" "),s("h3",{attrs:{id:"流编码格式"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流编码格式"}},[t._v("#")]),t._v(" 流编码格式")]),t._v(" "),s("h4",{attrs:{id:"h264"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#h264"}},[t._v("#")]),t._v(" H264")]),t._v(" "),s("p",[t._v("H264是一种视频编码格式，提供高效的视频压缩和高质量视频传输")]),t._v(" "),s("h4",{attrs:{id:"acc"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#acc"}},[t._v("#")]),t._v(" ACC")]),t._v(" "),s("p",[t._v("ACC是一种音频编码格式，用于压缩和传输音频数据")]),t._v(" "),s("h3",{attrs:{id:"码率"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#码率"}},[t._v("#")]),t._v(" 码率")]),t._v(" "),s("p",[t._v("码率（比特率），是指数据存储或传输时每秒传输的位数，码率越高，视频/音频质量越高")]),t._v(" "),s("p",[t._v("360p是指视频的垂直像素数。")]),t._v(" "),s("table",[s("thead",[s("tr",[s("th",[t._v("清晰度")]),t._v(" "),s("th",[t._v("分辨率")]),t._v(" "),s("th",[t._v("码率范围")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("360p标清")]),t._v(" "),s("td",[t._v("640x360")]),t._v(" "),s("td",[t._v("200 Kbps - 700 Kbps")])]),t._v(" "),s("tr",[s("td",[t._v("480pSD标清")]),t._v(" "),s("td",[t._v("854x480")]),t._v(" "),s("td",[t._v("500 Kbps - 2 Mbps")])]),t._v(" "),s("tr",[s("td",[t._v("720p高清")]),t._v(" "),s("td",[t._v("1280x720")]),t._v(" "),s("td",[t._v("1 Mbps - 4 Mbps")])]),t._v(" "),s("tr",[s("td",[t._v("1080p全高清")]),t._v(" "),s("td",[t._v("1920x1080")]),t._v(" "),s("td",[t._v("3 Mbps - 8 Mbps")])]),t._v(" "),s("tr",[s("td",[t._v("4K超高清")]),t._v(" "),s("td",[t._v("3840x2160")]),t._v(" "),s("td",[t._v("10 Mbps - 20 Mbps")])])])]),t._v(" "),s("h3",{attrs:{id:"视频流传输"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#视频流传输"}},[t._v("#")]),t._v(" 视频流传输")]),t._v(" "),s("ol",[s("li",[t._v("摄像头采集：使用摄像头设备（如USB摄像头、IP摄像头等）采集视频数据。这可以通过操作系统提供的摄像头驱动程序或相关的开发库来实现。")]),t._v(" "),s("li",[t._v("编码和压缩：采集到的原始视频数据可能会非常庞大，需要进行编码和压缩以减小数据大小。常见的视频编码标准包括H.264、H.265等。你可以使用编码器来将原始视频数据转换为所需的视频编码格式。")]),t._v(" "),s("li",[t._v("流媒体服务器：设置和配置流媒体服务器，如Nginx-RTMP、Wowza Streaming Engine等。确保服务器具备接收和处理视频流的能力，并配置相应的应用程序和流密钥。")]),t._v(" "),s("li",[t._v("推流：使用推流软件（如OBS）将编码后的视频流推送到流媒体服务器。在推流过程中，需要提供流媒体服务器的地址、应用程序名称和流密钥等信息。")]),t._v(" "),s("li",[t._v("流媒体传输：流媒体服务器接收到推送的视频流后，会根据配置的协议和格式进行传输。常见的流媒体传输协议包括RTMP、HLS、DASH等。服务器会生成相应的流媒体文件（如.ts文件、.m3u8文件等）并提供访问的URL。")]),t._v(" "),s("li",[t._v("前端播放：在前端页面上使用流媒体播放器（如Video.js、Hls.js、DPlayer等）进行视频流的播放。通过提供流媒体服务器生成的URL，前端播放器能够加载和播放视频流。")]),t._v(" "),s("li",[t._v("播放控制和交互：在前端页面上实现所需的播放控制和交互功能，如播放/暂停、音量控制、全屏等。这可以通过播放器提供的API或自定义的JavaScript代码来实现。")])]),t._v(" "),s("h2",{attrs:{id:"流媒体服务器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#流媒体服务器"}},[t._v("#")]),t._v(" 流媒体服务器")]),t._v(" "),s("h3",{attrs:{id:"srs"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#srs"}},[t._v("#")]),t._v(" SRS")]),t._v(" "),s("h3",{attrs:{id:"ams-adobe-media-server"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#ams-adobe-media-server"}},[t._v("#")]),t._v(" AMS（Adobe Media Server）")]),t._v(" "),s("h3",{attrs:{id:"wowza"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#wowza"}},[t._v("#")]),t._v(" wowza")]),t._v(" "),s("h2",{attrs:{id:"在线测试"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在线测试"}},[t._v("#")]),t._v(" 在线测试")]),t._v(" "),s("h3",{attrs:{id:"测试工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试工具"}},[t._v("#")]),t._v(" 测试工具")]),t._v(" "),s("p",[t._v("potplayer")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("https://potplayer.en.softonic.com/download\n")])])]),s("p",[t._v("m3u8测试")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("https://m3u8play.com/\n")])])]),s("h3",{attrs:{id:"测试地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#测试地址"}},[t._v("#")]),t._v(" 测试地址")]),t._v(" "),s("ul",[s("li",[t._v("hls测试")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 计时器\nhttp://playertest.longtailvideo.com/adaptive/bipbop/gear4/prog_index.m3u8\nhttps://assets.afcdn.com/video49/20210722/v_645516.m3u8\n\n")])])]),s("ul",[s("li",[t._v("rtsp")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("\n")])])]),s("ul",[s("li",[t._v("rtmp")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 伊拉克 电视台\nrtmp://ns8.indexforce.com/home/mystream\n// 韩国GOOD TV\nrtmp://mobliestream.c3tv.com:554/live/goodtv.sdp\n")])])]),s("ul",[s("li",[t._v("flv")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("// 西瓜视频测试\nhttps://sf1-hscdn-tos.pstatp.com/obj/media-fe/xgplayer_doc_video/flv/xgplayer-demo-360p.flv\n")])])]),s("ul",[s("li",[t._v("mp4")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("http://clips.vorwaerts-gmbh.de/big_buck_bunny.mp4\nhttp://vjs.zencdn.net/v/oceans.mp4\nhttps://media.w3.org/2010/05/sintel/trailer.mp4\n")])])]),s("h3",{attrs:{id:"浏览器插件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#浏览器插件"}},[t._v("#")]),t._v(" 浏览器插件")]),t._v(" "),s("p",[t._v("RTMP格式需要flash插件支持,可通过flash中心软件进行安装,其中:")]),t._v(" "),s("ul",[s("li",[t._v("ActiveX 版：适用于IE浏览器、Edge等软件IE模式调用，Edeg88以下")]),t._v(" "),s("li",[t._v("PPAPI版：适用于Chromium内核、360、QQ浏览器等等，Chrome88以下")]),t._v(" "),s("li",[t._v("NPAPI版：适用于基于火狐老版本浏览器，Firefox84以下")])]),t._v(" "),s("p",[t._v("flash在安全性、兼容性、性能以及跨平台等方面的问题，逐渐被H5替代")]),t._v(" "),s("h2",{attrs:{id:"前端接入视频流方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前端接入视频流方案"}},[t._v("#")]),t._v(" 前端接入视频流方案")]),t._v(" "),s("h3",{attrs:{id:"hls播放解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#hls播放解决方案"}},[t._v("#")]),t._v(" HLS播放解决方案")]),t._v(" "),s("h4",{attrs:{id:"使用video-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用video-js"}},[t._v("#")]),t._v(" 使用video.js")]),t._v(" "),s("p",[t._v("video.js有三种使用方式：")]),t._v(" "),s("ul",[s("li",[t._v("video标签")]),t._v(" "),s("li",[t._v("div嵌套video标签")]),t._v(" "),s("li",[t._v("video-js标签")])]),t._v(" "),s("p",[t._v("数据配置可以在标签中，也可以在js中。")]),t._v(" "),s("p",[t._v("使采用在video标签中引入的方式：")]),t._v(" "),s("div",{staticClass:"language-html extra-class"},[s("pre",{pre:!0,attrs:{class:"language-html"}},[s("code",[t._v("// video标签嵌入 \n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("video")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("my-video"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("video-js"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("controls")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("preload")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("auto"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("500px"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":src")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("https://bitdash-a.akamaihd.net/content/sintel/hls/playlist.m3u8"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("video")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])])]),s("p",[t._v("JS代码")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" videojs "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"video.js"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("videojs")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"my-video"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("bigPlayButton")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("textTrackDisplay")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("posterImage")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("errorDisplay")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("controlBar")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("play")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),s("h4",{attrs:{id:"使用hls-js-补充"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用hls-js-补充"}},[t._v("#")]),t._v(" 使用hls.js（补充）")]),t._v(" "),s("h3",{attrs:{id:"rtmp播放解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rtmp播放解决方案"}},[t._v("#")]),t._v(" RTMP播放解决方案")]),t._v(" "),s("h4",{attrs:{id:"使用video-js-2"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用video-js-2"}},[t._v("#")]),t._v(" 使用video.js")]),t._v(" "),s("ul",[s("li",[t._v("vue2使用vue-video-player")])]),t._v(" "),s("p",[t._v("vue-video-player 最高版本6.0.0")]),t._v(" "),s("p",[t._v("安装插件")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("npm install vue-video-player@^5.0.2 --save\nnpm install videojs-flash@^2.2.1 --save\n")])])]),s("p",[t._v("页面引入")]),t._v(" "),s("div",{staticClass:"language-js extra-class"},[s("pre",{pre:!0,attrs:{class:"language-js"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video.js/dist/video-js.css'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" videoPlayer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-video-player'")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'videojs-flash'")]),t._v("\n")])])]),s("p",[t._v("完整页面")]),t._v(" "),s("div",{staticClass:"language-vue extra-class"},[s("pre",{pre:!0,attrs:{class:"language-vue"}},[s("code",[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("videoPlayer")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("class")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("vjs-custom-skin videoPlayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("ref")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("videoplayer"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" \n\t\t"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":playsinline")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("90%"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v(":options")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("playerOptions"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v("\n    \t"),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("customEventName")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("changed"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),s("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("@play")]),s("span",{pre:!0,attrs:{class:"token attr-value"}},[s("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("onPlayerPlay($event)"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n     "),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("videoPlayer")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("template")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),s("span",{pre:!0,attrs:{class:"token script"}},[s("span",{pre:!0,attrs:{class:"token language-javascript"}},[t._v("\n\t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'video.js/dist/video-js.css'")]),t._v("\n \t"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" videoPlayer "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-video-player'")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'videojs-flash'")]),t._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"RTMP"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("components")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      videoPlayer\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("data")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("playerOptions")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//测试视频流数据")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("width")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"600"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("height")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"400"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("language")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'zh-CN'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("techOrder")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'flash'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("muted")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("autoplay")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("controls")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("loop")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("sources")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rtmp/mp4'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("src")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rtmp://mobliestream.c3tv.com:554/live/goodtv.sdp'")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//rtmp流地址")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// poster: 'static/fire/bgpp.png',")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// flash:{")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//   swf:'static/video-js.swf' //视频屏幕小于400x300时设置")]),t._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// }")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token tag"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("script")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n\n")])])]),s("ul",[s("li",[t._v("vue3使用@videojs-player/vue")])]),t._v(" "),s("h4",{attrs:{id:"使用flv-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用flv-js"}},[t._v("#")]),t._v(" 使用flv.js")]),t._v(" "),s("h3",{attrs:{id:"rtsp播放解决方案"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#rtsp播放解决方案"}},[t._v("#")]),t._v(" RTSP播放解决方案")]),t._v(" "),s("h4",{attrs:{id:"利用vlc插件转流"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#利用vlc插件转流"}},[t._v("#")]),t._v(" 利用VLC插件转流")]),t._v(" "),s("p",[t._v("浏览器安装VLC插件进行服务器转码映射，得到ogg格式然后播放")]),t._v(" "),s("p",[t._v("优点：可以直接播放RTSP，无需任何中介服务器帮助")]),t._v(" "),s("p",[t._v("缺点：手动安装插件，基于NPAPI，不被最新的Chrome和Firefox支持，适合兼容IE的项目")]),t._v(" "),s("h4",{attrs:{id:"html5-rtsp-player-websocket-rtsp-proxy"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#html5-rtsp-player-websocket-rtsp-proxy"}},[t._v("#")]),t._v(" html5_rtsp_player+websocket_rtsp_proxy")]),t._v(" "),s("ol",[s("li",[t._v("服务器安装streamedian服务器")]),t._v(" "),s("li",[t._v("客户端通过video标签播放")])]),t._v(" "),s("h4",{attrs:{id:"nginx-nginx-rtmp-module-rtmp转发-已成功"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-nginx-rtmp-module-rtmp转发-已成功"}},[t._v("#")]),t._v(" nginx + nginx-rtmp-module，rtmp转发（已成功）")]),t._v(" "),s("p",[t._v("本方案需要在摄像机登录页面推送rtmp流，因此相当于实现了rtmp流的转发")]),t._v(" "),s("ol",[s("li",[t._v("下载视频流测试工具"),s("a",{attrs:{href:"https://get.videolan.org/vlc/3.0.6/win64/vlc-3.0.6-win64.exe",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("vlc")]),s("OutboundLink")],1)]),t._v(" "),s("li",[t._v("安装nginx，"),s("a",{attrs:{href:"http://nginx-win.ecsds.eu/download/",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("下载地址")]),s("OutboundLink")],1),t._v("，选择nginx 1.7.11.3 Gryphon.zip")]),t._v(" "),s("li",[t._v("下载nginx-rtmp-module模块，"),s("a",{attrs:{href:"https://github.com/arut/nginx-rtmp-module",target:"_blank",rel:"noopener noreferrer"}},[s("strong",[t._v("官方地址")]),s("OutboundLink")],1),t._v("，解压后放在nginx安装根目录，百度网盘备用链接")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("链接：https://pan.baidu.com/s/1eG-hMjQHFHg0nalFBET1wA\n提取码：nutq\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("配置nginx的rtmp模块")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("rtmp{\n    server{\n        listen 1935;\n          #转发的地址\n        chunk_size 4000;\n        application live1 {\n            live on;\n            allow publish 127.0.0.1;#\n            allow play all;\n            record off;\n        }\n    }\n}\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[t._v("使用OBS推流至rtmp://127.0.0.1:1935/live1")]),t._v(" "),s("li",[t._v("使用vlc等工具测试rtmp://127.0.0.1:1935/live1是否能正常播放")])]),t._v(" "),s("h4",{attrs:{id:"nginx-rtmp-module-rtmp转hls播放-已成功"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#nginx-rtmp-module-rtmp转hls播放-已成功"}},[t._v("#")]),t._v(" nginx-rtmp-module，rtmp转hls播放（已成功）")]),t._v(" "),s("p",[t._v("默认URL")]),t._v(" "),s("p",[t._v("http://127.0.0.1/hls1/playlist.m3u8")]),t._v(" "),s("p",[t._v("配置方式和rtmp转发类似，不过需要配置hls转码")]),t._v(" "),s("ol",[s("li",[t._v("配置hls转码")])]),t._v(" "),s("p",[t._v("​\thls_path 可以配置在别的路径，容易识别的")]),t._v(" "),s("div",{staticClass:"language-nginx extra-class"},[s("pre",{pre:!0,attrs:{class:"language-nginx"}},[s("code",[s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("application")]),t._v(" hls1")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("live")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 直播模式，允许客户端通过RTMP进行直播流传输")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 启用HLS，允许将直播流转换为HLS格式并进行分片")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls_cleanup")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 过期自动清理")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls_nested")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("on")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 可以嵌套目录存储HLS分片文件")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("record")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("off")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 禁用录制功能")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls_fragment")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2s")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 每个hls分片时长")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls_playlist_length")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# hls播放列表的分片数目")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token directive"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("hls_path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"E:/Program Files/Nginx/nginx-1.7.11.3-Gryphon/hls-path/live1"')])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# HLS片段存储路径")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("配置http访问路径,添加Location")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v('location /hls1 {\n    # Serve HLS fragments\n    add_header Access-Control-Allow-Origin *;\n    add_header Cache-Control no-cache;\n    types {\n        application/vnd.apple.mpegurl m3u8;\n        video/mp2t ts;\n    }\n    alias "E:/Program Files/Nginx/nginx-1.7.11.3-Gryphon/hls-path/live1"; # 映射到实际目录\n    expires -1; # 不被缓存\n}\n')])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("OBS推流到指定URL,进行测试")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("rtmp://localhost:1935/hls1\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("VLC测试URL")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("http://127.0.0.1:9000/hls1/index.m3u8\n")])])]),s("p",[t._v("chrome浏览器实测，同时展示8个，会非常卡顿")])])}),[],!1,null,null,null);s.default=e.exports}}]);