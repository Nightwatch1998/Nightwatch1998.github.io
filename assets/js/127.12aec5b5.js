(window.webpackJsonp=window.webpackJsonp||[]).push([[127],{411:function(a,t,e){"use strict";e.r(t);var s=e(10),r=Object(s.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h1",{attrs:{id:"geoserver-学习记录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#geoserver-学习记录"}},[a._v("#")]),a._v(" GeoServer 学习记录")]),a._v(" "),t("h2",{attrs:{id:"基础"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基础"}},[a._v("#")]),a._v(" 基础")]),a._v(" "),t("p",[a._v("GeoServer 是一个基于Java的服务器，建立在GeoTools之上，用于查看和编辑GIS数据，内部集成了Openlayers。"),t("a",{attrs:{href:"https://docs.geoserver.org/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方文档"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"下载安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载安装"}},[a._v("#")]),a._v(" 下载安装")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://sourceforge.net/projects/geoserver/files/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官网下载"),t("OutboundLink")],1),a._v("下载生产版本，解压至目标文件夹")]),a._v(" "),t("ul",[t("li",[a._v("Platform Independent Binary 独立于平台的二进制文件")]),a._v(" "),t("li",[a._v("Windows Installer windows 环境的jar包，必须有java环境 "),t("strong",[a._v("开发环境")])]),a._v(" "),t("li",[a._v("Web Archive  war包，可以丢在tomcat里启动  "),t("strong",[a._v("生产环境")])])]),a._v(" "),t("p",[a._v("windows环境安装 需要配置java环境")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://docs.geoserver.org/latest/en/user/installation/linux.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("linux环境下安装"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"启动"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#启动"}},[a._v("#")]),a._v(" 启动")]),a._v(" "),t("p",[a._v("进入bin目录，执行命令：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("startup.sh\n")])])]),t("p",[a._v("浏览器中输入：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("http://localhost:8080/geoserver\n")])])]),t("p",[a._v("账户名密码：")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("用户名：admin，密码：geoserver\n")])])]),t("h3",{attrs:{id:"版本特性"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#版本特性"}},[a._v("#")]),a._v(" 版本特性")]),a._v(" "),t("ul",[t("li",[a._v("版本2.22.x 需要Java8或者Java11环境，"),t("strong",[a._v("建议使用Java8版本")])]),a._v(" "),t("li",[a._v("版本2.23.x以后 需要Java11或者Java17环境，"),t("strong",[a._v("建议使用Java11版本")]),a._v("，Java17会报错")]),a._v(" "),t("li",[a._v("版本2.6以前使用Jetty作为内置服务器，之后使用tomcat")])]),a._v(" "),t("h3",{attrs:{id:"geoserver跨域问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#geoserver跨域问题"}},[a._v("#")]),a._v(" geoserver跨域问题")]),a._v(" "),t("p",[a._v("修改geoserver\\webapps\\geoserver\\WEB-INF\\web.xml文件")]),a._v(" "),t("p",[a._v("将下面这两段取消注释")]),a._v(" "),t("div",{staticClass:"language-xml extra-class"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[a._v("   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- Uncomment following filter to enable CORS in Jetty. Do not forget the second config block further down.\n    <filter>\n      <filter-name>cross-origin</filter-name>\n      <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class>\n      <init-param>\n        <param-name>chainPreflight</param-name>\n        <param-value>false</param-value>\n      </init-param>\n      <init-param>\n        <param-name>allowedOrigins</param-name>\n        <param-value>*</param-value>\n      </init-param>\n      <init-param>\n        <param-name>allowedMethods</param-name>\n        <param-value>GET,POST,PUT,DELETE,HEAD,OPTIONS</param-value>\n      </init-param>\n      <init-param>\n        <param-name>allowedHeaders</param-name>\n        <param-value>*</param-value>\n      </init-param>\n    </filter>\n    --\x3e")]),a._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- Uncomment following filter to enable CORS\n    <filter-mapping>\n        <filter-name>cross-origin</filter-name>\n        <url-pattern>/*</url-pattern>\n    </filter-mapping>\n    --\x3e")]),a._v("\n")])])]),t("h3",{attrs:{id:"更改缓存目录"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#更改缓存目录"}},[a._v("#")]),a._v(" 更改缓存目录")]),a._v(" "),t("p",[a._v("打开webapps/geoserver/WEB-INF下的web.xml文件，在display-name节点后面添加一下内容：")]),a._v(" "),t("p",[a._v("路径为自定义的缓存数据路径")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v(" <context-param>\n       <param-name>GEOWEBCACHE_CACHE_DIR</param-name>\n       <param-value>E:\\ProgramData\\Geoserver_Tiles</param-value>\n </context-param>\n")])])]),t("h2",{attrs:{id:"发布wms服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布wms服务"}},[a._v("#")]),a._v(" 发布WMS服务")]),a._v(" "),t("h3",{attrs:{id:"发布图像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布图像"}},[a._v("#")]),a._v(" 发布图像")]),a._v(" "),t("ol",[t("li",[t("p",[t("strong",[a._v("数据准备")]),a._v("，放置在数据目录目录E:\\ProgramData\\geoserver\\data下")])]),a._v(" "),t("li",[t("p",[t("strong",[a._v("创建工作区")]),a._v("，指定名称和url")])]),a._v(" "),t("li",[t("p",[t("strong",[a._v("创建一个数据Store")]),a._v(":数据源选择WorldImage,选择本地影像")])]),a._v(" "),t("li",[t("p",[t("strong",[a._v("创建一个图层")]),a._v(":新建图层、选择数据、点击发布，进入配置页面")]),a._v(" "),t("ul",[t("li",[a._v("基本参考信息：命名、标题、摘要")]),a._v(" "),t("li",[a._v("坐标参考系统：强制声明会使用内部EPSG定义的WGS84，而非提供的 投影文件")]),a._v(" "),t("li",[a._v("边框：由SRS计算，由native计算")])]),a._v(" "),t("p",[a._v("配置完成后，点击发布")]),a._v(" "),t("ul",[t("li",[a._v("预览图层:")])]),a._v(" "),t("p",[a._v("注：SRS是指空间参考系统")])])]),a._v(" "),t("h3",{attrs:{id:"发布geopackage"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布geopackage"}},[a._v("#")]),a._v(" 发布GeoPackage")]),a._v(" "),t("p",[a._v("和发布图像类似，store和数据源有所不同")]),a._v(" "),t("h3",{attrs:{id:"发布图层组"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布图层组"}},[a._v("#")]),a._v(" 发布图层组")]),a._v(" "),t("ol",[t("li",[a._v("首先发布若干单个图层")]),a._v(" "),t("li",[a._v("创建图层组，可以将同一工作空间的不同图层组合在一起，并调整顺序")]),a._v(" "),t("li",[a._v("确定坐标系，生成边界")])]),a._v(" "),t("h3",{attrs:{id:"发布样式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布样式"}},[a._v("#")]),a._v(" 发布样式")]),a._v(" "),t("ol",[t("li",[a._v("创建样式")]),a._v(" "),t("li",[a._v("输入名称、选择工作空间、格式和图例")]),a._v(" "),t("li",[a._v("选择样式内容，并生成配置文件xml，自定义样式文件")]),a._v(" "),t("li",[a._v("在发布页面，找到对应的图层")]),a._v(" "),t("li",[a._v("在图层预览中浏览")])]),a._v(" "),t("h3",{attrs:{id:"发布shapefile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布shapefile"}},[a._v("#")]),a._v(" 发布shapefile")]),a._v(" "),t("ol",[t("li",[a._v("创建数据store，选择数据源shp文件，指定DBF 字符集")]),a._v(" "),t("li",[a._v("在发布界面，由数据生成边界框，投影的和经纬度的")])]),a._v(" "),t("h3",{attrs:{id:"发布postgis-table"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布postgis-table"}},[a._v("#")]),a._v(" 发布PostGIS table")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://docs.geoserver.org/latest/en/user/gettingstarted/postgis-quickstart/index.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("发布postgis表"),t("OutboundLink")],1)]),a._v(" "),t("ol",[t("li",[a._v("首先安装postgresql和对应版本的postgis扩展")]),a._v(" "),t("li",[a._v("创建数据库并导入官方案例数据")]),a._v(" "),t("li",[a._v("在geoserver页面创建新的数据仓库，添加postgis数据,配置连接参数")]),a._v(" "),t("li",[a._v("添加新的图层，选择刚刚创建的数据仓库，计算边界框")]),a._v(" "),t("li",[a._v("发布界面设置数据类型为polygon，保存")])]),a._v(" "),t("h2",{attrs:{id:"发布wmts服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布wmts服务"}},[a._v("#")]),a._v(" 发布WMTS服务")]),a._v(" "),t("p",[a._v("Geoserver内置了GeoWebCache服务，可以将图层提前切片保存")]),a._v(" "),t("h3",{attrs:{id:"图层切片"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#图层切片"}},[a._v("#")]),a._v(" 图层切片")]),a._v(" "),t("ul",[t("li",[a._v("在Tile Layers中找到对应的图层 点击seed/Truncate")]),a._v(" "),t("li",[a._v("编辑图层切片参数")]),a._v(" "),t("li",[a._v("点击submit创建切片任务")]),a._v(" "),t("li",[a._v("切出的地图瓦片在geoserver\\gwc\\huyadish_basemap目录")]),a._v(" "),t("li",[a._v("可在预览中查看服务URL")])]),a._v(" "),t("h3",{attrs:{id:"cesium中使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#cesium中使用"}},[a._v("#")]),a._v(" Cesium中使用")]),a._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[a._v("// 原始URL\nhttp://localhost:8080/geoserver/gwc/service/wmts/rest/huyadish:basemap/{style}/{TileMatrixSet}/{TileMatrix}/{TileRow}/{TileCol}?format=image/png\n\n// cesium中修改\nhttp://localhost:8080/geoserver/gwc/service/wmts/rest/huyadish:basemap/{style}/{TileMatrixSet}/{TileMatrixSet}:{TileMatrix}/{TileRow}/{TileCol}?format=image/png\n")])])]),t("p",[a._v("使用案例")]),a._v(" "),t("div",{staticClass:"language-js extra-class"},[t("pre",{pre:!0,attrs:{class:"language-js"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 本地发布的WMS服务,layers可选countries、SR_50M、basemap")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("const")]),a._v(" geoserverWMSProvider "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Cesium"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("WebMapServiceImageryProvider")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http://localhost:8080/geoserver/huyadish/wms'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("layers")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'huyadish:countries'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("parameters")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("service")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'WMS'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 这里要看geoserver发布服务支持的格式,png、gif、jpeg")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'image/png'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n    "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 这里1.1.1和1.1.0均可")]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("version")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'1.1.1'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" \n    "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("transparent")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("true")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 本地发布的WMTS服务")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("const")]),a._v(" geoserverWMTSProvider "),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("new")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Cesium"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("WebMapTileServiceImageryProvider")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("url")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'http://localhost:8080/geoserver/gwc/service/wmts/rest/huyadish:basemap/{style}/{TileMatrixSet}/{TileMatrixSet}:{TileMatrix}/{TileRow}/{TileCol}?format=image/png'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("layer")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'huyadish:basemap'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("style")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("''")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("format")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'image/png'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("tileMatrixSetID")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[a._v("'EPSG:900913'")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("//EPSG需要修改")]),a._v("\n  "),t("span",{pre:!0,attrs:{class:"token literal-property property"}},[a._v("maximumLevel")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])])]),t("h2",{attrs:{id:"发布wcf服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布wcf服务"}},[a._v("#")]),a._v(" 发布WCF服务")]),a._v(" "),t("h2",{attrs:{id:"发布wfs服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#发布wfs服务"}},[a._v("#")]),a._v(" 发布WFS服务")]),a._v(" "),t("h2",{attrs:{id:"系统信息查看"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#系统信息查看"}},[a._v("#")]),a._v(" 系统信息查看")])])}),[],!1,null,null,null);t.default=r.exports}}]);