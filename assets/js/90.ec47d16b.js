(window.webpackJsonp=window.webpackJsonp||[]).push([[90],{374:function(t,a,s){"use strict";s.r(a);var _=s(10),r=Object(_.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"learnopengl-06pbr"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#learnopengl-06pbr"}},[t._v("#")]),t._v(" LearnOpenGL-06PBR")]),t._v(" "),a("h2",{attrs:{id:"pbr材质"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pbr材质"}},[t._v("#")]),t._v(" PBR材质")]),t._v(" "),a("p",[t._v("PBR，是指"),a("code",[t._v("基于物理的渲染")]),t._v("(Physically Based Rendering)，它指的是基于与现实世界的物理原理更相符的渲染技术的集合。")]),t._v(" "),a("h3",{attrs:{id:"微平面模型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#微平面模型"}},[t._v("#")]),t._v(" 微平面模型")]),t._v(" "),a("p",[a("code",[t._v("微平面理论")]),t._v("认为达到微观尺度后任何平面都可以用"),a("code",[t._v("微平面")]),t._v("的细小镜面来描绘。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/microfacets_light_rays.png",alt:"microfacets_light_rays"}})]),t._v(" "),a("p",[t._v("粗糙度：用统计学的方法估计微平面的粗糙程度。粗糙度通常记为α，范围0-1。")]),t._v(" "),a("p",[t._v("半程向量h：光线向量l和视线向量v之间的单位化中间向量。\n$$\nh = \\frac{l + v}{|l + v|}\n$$\n微平面的朝向方向与半程向量的方向越是一致，镜面反射的效果就越是强烈越是锐利。粗糙度越高，镜面反射的轮廓越大。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/ndf.png",alt:"ndf"}})]),t._v(" "),a("h3",{attrs:{id:"能量守恒"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#能量守恒"}},[t._v("#")]),t._v(" 能量守恒")]),t._v(" "),a("p",[t._v("反射光线和折射光线的能量总和不会超过入射光线。")]),t._v(" "),a("div",{staticClass:"language-cpp extra-class"},[a("pre",{pre:!0,attrs:{class:"language-cpp"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),t._v(" kS "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("calculateSpecularComponent")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 反射/镜面 部分")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("float")]),t._v(" kD "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v(" ks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("                        "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 折射/漫反射 部分")]),t._v("\n")])])]),a("p",[t._v("反射率方程：表示从观察方向上观察，光线投射到点p上反射出的辐射率的总和。\n$$\nL_o(p,\\omega_o) = \\int\\limits_{\\Omega} f_r(p,\\omega_i,\\omega_o) L_i(p,\\omega_i) n \\cdot \\omega_i  d\\omega_i\n$$\n辐射率被用来量化来自单一方向上的光线的大小或者强度。")]),t._v(" "),a("p",[a("strong",[t._v("辐射通量")]),t._v("：辐射通量Φ表示的是一个光源所输出的能量，以瓦特为单位。")]),t._v(" "),a("p",[a("strong",[t._v("立体角")]),t._v("：立体角用ω表示，它可以为我们描述投射到单位球体上的一个截面的大小或者面积。")]),t._v(" "),a("p",[a("strong",[t._v("辐射强度")]),t._v("：辐射强度(Radiant Intensity)表示的是在单位球面上，一个光源向每单位立体角所投送的辐射通量。")]),t._v(" "),a("p",[t._v("计算辐射强度：\n$$\nI = \\frac{d\\Phi}{d\\omega}\n$$\n"),a("strong",[t._v("辐射照度")]),t._v(":当涉及到辐射率时，我们通常关心的是"),a("strong",[t._v("所有")]),t._v("投射到点p上的光线的总和，而这个和就称为辐射照度或者辐照度")]),t._v(" "),a("h3",{attrs:{id:"brdf"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#brdf"}},[t._v("#")]),t._v(" BRDF")]),t._v(" "),a("p",[t._v("双向反射分布函数BRDF：可以近似的求出每束光线对一个给定了材质属性的平面上最终反射出来的光线所作出的贡献程度。")]),t._v(" "),a("p",[t._v("Cook-Torrance BRDF兼有漫反射和镜面反射两个部分：\n$$\nf_r = k_d f_{lambert} +  k_s f_{cook-torrance}\n$$\n漫反射部分：对表面颜色进行标准化\n$$\nf_{lambert} = \\frac{c}{\\pi}\n$$\n镜面反射部分：\n$$\nf_{cook-torrance} = \\frac{DFG}{4(\\omega_o \\cdot n)(\\omega_i \\cdot n)}\n$$")]),t._v(" "),a("blockquote",[a("p",[t._v("分子是三个函数：")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("法线分布函数")]),t._v("：估算在受到表面粗糙度的影响下，朝向方向与半程向量一致的微平面的数量。这是用来估算微平面的主要函数。")]),t._v(" "),a("li",[a("strong",[t._v("几何函数")]),t._v("：描述了微平面自成阴影的属性。当一个平面相对比较粗糙的时候，平面表面上的微平面有可能挡住其他的微平面从而减少表面所反射的光线。")]),t._v(" "),a("li",[a("strong",[t._v("菲涅尔方程")]),t._v("：菲涅尔方程描述的是在不同的表面角下表面所反射的光线所占的比率。")])])]),t._v(" "),a("p",[t._v("D使用Trowbridge-Reitz GGX，F使用Fresnel-Schlick近似(Fresnel-Schlick Approximation)，而G使用Smith’s Schlick-GGX。")]),t._v(" "),a("h3",{attrs:{id:"法线分布函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#法线分布函数"}},[t._v("#")]),t._v(" 法线分布函数")]),t._v(" "),a("p",[t._v("法线分布函数D，从统计学上近似的表示了与半程向量h取向一致的微平面的比率。\n$$\nNDF_{GGX TR}(n, h, \\alpha) = \\frac{\\alpha^2}{\\pi((n \\cdot h)^2 (\\alpha^2 - 1) + 1)^2}\n$$\nα是粗糙度，h是半程向量，n是法线方向。")]),t._v(" "),a("h3",{attrs:{id:"几何函数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#几何函数"}},[t._v("#")]),t._v(" 几何函数")]),t._v(" "),a("p",[t._v("几何函数从统计学上近似求得微平面间相互遮挡的比率，这种遮挡会损耗光线能量。")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/geometry_shadowing.png",alt:"geometry_shadowing"}})]),t._v(" "),a("p",[t._v("几何函数采用一个材料的粗糙度参数作为输入参数，粗糙度较高的表面其微平面间相互遮蔽的概率就越高。\n$$\nG_{SchlickGGX}(n, v, k) = \\frac{n \\cdot v}{(n \\cdot v)(1 - k) + k }\n$$\nk是α的重映射，分为直接光照和针对IBL光照。")]),t._v(" "),a("p",[t._v("几何函数是一个值域为[0.0, 1.0]的数，其中白色或者说1.0表示没有微平面阴影，而黑色或者说0.0则表示微平面彻底被遮蔽。")]),t._v(" "),a("h3",{attrs:{id:"菲涅尔方程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#菲涅尔方程"}},[t._v("#")]),t._v(" 菲涅尔方程")]),t._v(" "),a("p",[t._v("菲涅尔（发音为Freh-nel）方程描述的是被反射的光线对比光线被折射的部分所占的比率，这个比率会随着我们观察的角度不同而不同。\n$$\nF_{Schlick}(h, v, F_0) = F_0 + (1 - F_0) ( 1 - (h \\cdot v))^5\n$$\nF0表示平面的基础反射率")]),t._v(" "),a("blockquote",[a("p",[t._v("电介质材质表面的基础反射率不高于0.17。")]),t._v(" "),a("p",[t._v("金属材质表面反射率在0.5-1.0之间。")]),t._v(" "),a("p",[t._v("金属表面基础反射率是带有色彩的，反射率与波长有关。")])]),t._v(" "),a("p",[t._v("金属度用来描述一个材质表面是金属还是非金属的。")]),t._v(" "),a("h3",{attrs:{id:"cook-torrance反射率方程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cook-torrance反射率方程"}},[t._v("#")]),t._v(" Cook-Torrance反射率方程")]),t._v(" "),a("p",[t._v("$$\nL_o(p,\\omega_o) = \\int\\limits_{\\Omega} (k_d\\frac{c}{\\pi} + k_s\\frac{DFG}{4(\\omega_o \\cdot n)(\\omega_i \\cdot n)})L_i(p,\\omega_i) n \\cdot \\omega_i  d\\omega_i\n$$")]),t._v(" "),a("h3",{attrs:{id:"编写pbr材质"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写pbr材质"}},[t._v("#")]),t._v(" 编写PBR材质")]),t._v(" "),a("p",[t._v("在下面你可以看到在一个PBR渲染管线当中经常会碰到的纹理列表，还有将它们输入PBR渲染器所能得到的相应的视觉输出：")]),t._v(" "),a("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/textures.png",alt:"textures"}}),t._v(" "),a("p",[t._v("PBR材质包含的纹理贴图：")]),t._v(" "),a("ul",[a("li",[t._v("反照率：为每个金属的纹理像素指定表面颜色或者基础反射率。")]),t._v(" "),a("li",[t._v("法线：为表面制造出凹凸不平的效果。")]),t._v(" "),a("li",[t._v("金属度：指定每个纹理像素是不是金属质地的。")]),t._v(" "),a("li",[t._v("粗糙度：指定某个表面有多粗糙。")]),t._v(" "),a("li",[t._v("AO：环境光遮蔽为表面和周围潜在的几何图形指定了额外的阴影因子。")])]),t._v(" "),a("h2",{attrs:{id:"光照"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#光照"}},[t._v("#")]),t._v(" 光照")]),t._v(" "),a("h2",{attrs:{id:"ibl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#ibl"}},[t._v("#")]),t._v(" IBL")])])}),[],!1,null,null,null);a.default=r.exports}}]);