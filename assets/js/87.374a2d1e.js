(window.webpackJsonp=window.webpackJsonp||[]).push([[87],{370:function(t,s,a){"use strict";a.r(s);var n=a(10),e=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"learnopengl-03模型加载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#learnopengl-03模型加载"}},[t._v("#")]),t._v(" LearnOpenGL-03模型加载")]),t._v(" "),s("p",[t._v("3D建模工具：Blender、3DS MAX、Maya。这些工具在导出模型文件时自动生成顶点坐标、顶点法线和纹理坐标。")]),t._v(" "),s("blockquote",[s("p",[t._v("3D数据格式：")]),t._v(" "),s("ul",[s("li",[t._v("obj:只包含了模型数据以及材质信息，像是模型颜色和漫反射/镜面光贴图。")]),t._v(" "),s("li",[t._v("collada:模型、光照、多种材质、动画数据、摄像机、完整的场景信息。")])])]),t._v(" "),s("h2",{attrs:{id:"模型加载库assimp"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模型加载库assimp"}},[t._v("#")]),t._v(" 模型加载库Assimp")]),t._v(" "),s("p",[t._v("当使用Assimp导入一个模型的时候，它通常会将整个模型加载进一个"),s("strong",[t._v("场景")]),t._v("(Scene)对象，它会包含导入的模型/场景中的所有数据。")]),t._v(" "),s("blockquote",[s("ul",[s("li",[t._v("和材质和网格(Mesh)一样，所有的场景/模型数据都包含在Scene对象中。Scene对象也包含了场景根节点的引用。")]),t._v(" "),s("li",[t._v("场景的Root node（根节点）可能包含子节点（和其它的节点一样），它会有一系列指向场景对象中mMeshes数组中储存的网格数据的索引。Scene下的mMeshes数组储存了真正的Mesh对象，节点中的mMeshes数组保存的只是场景中网格数组的索引。")]),t._v(" "),s("li",[t._v("一个Mesh对象本身包含了渲染所需要的所有相关数据，像是顶点位置、法向量、纹理坐标、面(Face)和物体的材质。")]),t._v(" "),s("li",[t._v("一个网格包含了多个面。Face代表的是物体的渲染图元(Primitive)（三角形、方形、点）。一个面包含了组成图元的顶点的索引。由于顶点和索引是分开的，使用一个索引缓冲来渲染是非常简单的（见[你好，三角形](https://learnopengl-cn.github.io/01 Getting started/04 Hello Triangle/)）。")]),t._v(" "),s("li",[t._v("最后，一个网格也包含了一个Material对象，它包含了一些函数能让我们获取物体的材质属性，比如说颜色和纹理贴图（比如漫反射和镜面光贴图）。")])])]),t._v(" "),s("h2",{attrs:{id:"网格"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#网格"}},[t._v("#")]),t._v(" 网格")]),t._v(" "),s("p",[t._v("网格Mesh 是绘制三维图形的基本单元，一个模型会包含多个mesh。")]),t._v(" "),s("p",[t._v("比如一个人物的模型。可能包含胳膊、腿、脑袋，这些是单独建模的。所以有一个场景节点的概念，场景根节点指向了若干mesh的索引。")]),t._v(" "),s("p",[t._v("绘制函数：")]),t._v(" "),s("ol",[s("li",[t._v("遍历模型的所有纹理，为每个纹理分配对应的"),s("strong",[t._v("OpenGL 纹理单元")]),t._v("，并将纹理的单元编号传递给着色器中的材质变量。")]),t._v(" "),s("li",[t._v("绑定纹理到对应的纹理单元，让着色器能够正确采样纹理。")]),t._v(" "),s("li",[t._v("绑定顶点数组对象（VAO）并绘制网格的三角形面，完成模型的渲染。")])]),t._v(" "),s("h2",{attrs:{id:"模型"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#模型"}},[t._v("#")]),t._v(" 模型")]),t._v(" "),s("div",{staticClass:"language-glsl extra-class"},[s("pre",{pre:!0,attrs:{class:"language-glsl"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" Model \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*  函数   */")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Model")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("char "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadModel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("Draw")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Shader shader"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("   \n    private"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*  模型数据  */")]),t._v("\n        vector"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Mesh"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" meshes"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        string directory"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*  函数   */")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadModel")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("string path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("void")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("processNode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aiNode "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("node"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" aiScene "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("scene"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        Mesh "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("processMesh")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aiMesh "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mesh"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" aiScene "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("scene"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        vector"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("Texture"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("loadMaterialTextures")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("aiMaterial "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("mat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" aiTextureType type"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" \n                                             string typeName"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);