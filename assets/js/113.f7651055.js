(window.webpackJsonp=window.webpackJsonp||[]).push([[113],{397:function(a,s,t){"use strict";t.r(s);var e=t(10),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"pm2进程管理工具"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#pm2进程管理工具"}},[a._v("#")]),a._v(" PM2进程管理工具")]),a._v(" "),s("h2",{attrs:{id:"概述"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概述"}},[a._v("#")]),a._v(" 概述")]),a._v(" "),s("p",[a._v("PM2是一个守护进程管理工具，由nodejs语言编写，通过CLI命令行工作，可以用于启动和管理nodejs、python、java应用。")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("// 安装\nnpm install pm2 -g\n\n// 测试\npm2 -v\n")])])]),s("p",[a._v("如果没有打印成功，可以把pm2全局安装路径下的bin目录添加到系统环境变量，例如")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("E:\\Program Files x86\\Nodejs\\node_global\\node_modules\\pm2\\bin\n")])])]),s("h2",{attrs:{id:"启动应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动应用"}},[a._v("#")]),a._v(" 启动应用")]),a._v(" "),s("h3",{attrs:{id:"启动nodejs应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动nodejs应用"}},[a._v("#")]),a._v(" 启动nodejs应用")]),a._v(" "),s("p",[a._v("最简单方式")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 start app.js\n")])])]),s("p",[a._v("默认会在"),s("code",[a._v("C:\\Users\\gh326\\.pm2\\logs")]),a._v("生成日志文件")]),a._v(" "),s("h3",{attrs:{id:"启动java应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动java应用"}},[a._v("#")]),a._v(" 启动java应用")]),a._v(" "),s("ul",[s("li",[a._v("通过命令行启动：")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("$ pm2 start -n my-app-name java -- -jar ./appName.jar\n")])])]),s("ul",[s("li",[a._v("通过json文件启动，在 jar 包同级目录创建 "),s("code",[a._v("app.json")]),a._v("：")])]),a._v(" "),s("div",{staticClass:"language-json extra-class"},[s("pre",{pre:!0,attrs:{class:"language-json"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"apps"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"name"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"my-app-name"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 应用名称，可自定义")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"script"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 命令名称")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"error_file"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"./log/err.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 错误日志路径")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"out_file"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"./log/out.log"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 输出日志路径")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"log_date_format"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"YYYY/MM/DD HH:mm:ss"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("// 日志日期格式")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token property"}},[a._v('"args"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"appName.jar"')]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])])]),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 start app.json\n")])])]),s("blockquote",[s("p",[a._v("注意：")]),a._v(" "),s("p",[a._v("​\t一般jar包会默认配置日志，因此可以禁用pm2日志，可以将"),s("code",[a._v("error_file")]),a._v("和"),s("code",[a._v("out_file")]),a._v("的值设置为固定值"),s("code",[a._v('"/dev/null"')]),a._v("，和平台无关。")])]),a._v(" "),s("h3",{attrs:{id:"启动python应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动python应用"}},[a._v("#")]),a._v(" 启动python应用")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 start python_web.py --interpreter python3\n")])])]),s("h2",{attrs:{id:"管理应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#管理应用"}},[a._v("#")]),a._v(" 管理应用")]),a._v(" "),s("p",[a._v("通过进程name或id管理进程")]),a._v(" "),s("ul",[s("li",[a._v("启动应用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 start app.js\n")])])]),s("ul",[s("li",[a._v("停止应用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 stop name \n")])])]),s("ul",[s("li",[a._v("重启应用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 reload name\n")])])]),s("ul",[s("li",[a._v("删除应用")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 delete name\n")])])]),s("h2",{attrs:{id:"进程检查"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#进程检查"}},[a._v("#")]),a._v(" 进程检查")]),a._v(" "),s("ul",[s("li",[a._v("查看服务信息")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 ls\n")])])]),s("ul",[s("li",[a._v("打印日志")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 logs -h\n")])])]),s("ul",[s("li",[a._v("显示1000行")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 logs server --lines 1000\n")])])]),s("ul",[s("li",[a._v("仪表盘监测")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 monit\n")])])]),s("ul",[s("li",[a._v("清空日志")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 flush server\n")])])]),s("h2",{attrs:{id:"开启自启"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#开启自启"}},[a._v("#")]),a._v(" 开启自启")]),a._v(" "),s("h3",{attrs:{id:"windows环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#windows环境"}},[a._v("#")]),a._v(" windows环境")]),a._v(" "),s("ul",[s("li",[a._v("安装Windows自启动包")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("npm install pm2-windows-startup -g\n")])])]),s("p",[a._v("创建开机自启动脚本")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2-startup install\n")])])]),s("p",[a._v("随后在启动、更改、删除进程后执行：")]),a._v(" "),s("ul",[s("li",[a._v("保存应用程序列表")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 save\n")])])]),s("ul",[s("li",[a._v("恢复保存的进程")])]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("pm2 resurrect\n")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);