(window.webpackJsonp=window.webpackJsonp||[]).push([[29],{313:function(t,s,a){"use strict";a.r(s);var n=a(10),r=Object(n.a)({},(function(){var t=this,s=t._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"动手深度学习-pytorch版"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#动手深度学习-pytorch版"}},[t._v("#")]),t._v(" 动手深度学习-Pytorch版")]),t._v(" "),s("h2",{attrs:{id:"前言"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#前言"}},[t._v("#")]),t._v(" 前言")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zh-v2.d2l.ai/chapter_preface/index.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("中文文档地址"),s("OutboundLink")],1),t._v("，可下载代码")]),t._v(" "),s("p",[t._v("目前学习的部分章节，直观地感受是，本书注重于描述模型的抽象结构、以及公式推导。每种模型讲的都不深，但是面面俱到，可以作为机器学习的通识类读物。书中的代码经过验证也都是可运行的，但都是碎片化的案例，可以让学到机器学习程序的基本结构，缺乏工程化的机器学习框架思路。")]),t._v(" "),s("h2",{attrs:{id:"预备知识"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#预备知识"}},[t._v("#")]),t._v(" 预备知识")]),t._v(" "),s("h3",{attrs:{id:"jupyter-notebook"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#jupyter-notebook"}},[t._v("#")]),t._v(" Jupyter Notebook")]),t._v(" "),s("p",[t._v("Jupyter Notebook是一款开源的交互式计算工具，主要用于创建包含实时代码、富文本、数学公式、图表、可视化等内容的文档（文件扩展名为 "),s("code",[t._v(".ipynb")]),t._v("）")]),t._v(" "),s("p",[t._v("使用方法：")]),t._v(" "),s("ol",[s("li",[t._v("下载安装")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("pip3 "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" notebook\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("进入ipynb资源目录，运行notebook")])]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("jupyter notebook\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("打开浏览器，http://localhost:8888/tree")])]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251114110007305.png",alt:"image-20251114110007305"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251114110103005.png",alt:"image-20251114110103005"}})]),t._v(" "),s("h3",{attrs:{id:"如何在conda环境运行jupyter呢"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#如何在conda环境运行jupyter呢"}},[t._v("#")]),t._v(" 如何在conda环境运行jupyter呢？")]),t._v(" "),s("ol",[s("li",[t._v("base 环境安装jupyter")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("activate base\nconda "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" jupyter jupyterlab\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("在目标环境安装内核")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("conda activate myproject\nconda "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ipykernel "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 安装内核")]),t._v("\npython "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-m")]),t._v(" ipykernel "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--user")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--name")]),t._v(" myproject --display-name "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Python (myproject)"')]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 注册为jupyter 可选kernel")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("在base环境运行")])]),t._v(" "),s("div",{staticClass:"language-bash extra-class"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[t._v("jupyter lab  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 功能更丰富的网页端")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 或者")]),t._v("\njupyter notebook\n")])])]),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251115215653418.png",alt:"image-20251115215653418"}})]),t._v(" "),s("h3",{attrs:{id:"数据操作"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据操作"}},[t._v("#")]),t._v(" 数据操作")]),t._v(" "),s("ol",[s("li",[t._v("torch基础操作")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 创建张量")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("shape "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看张量形状")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("numel"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看元素数量")]),t._v("\n    \nX "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 改变张量形状")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用0初始化")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("ones"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用1初始化")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("randn"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用随机数初始化")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 用嵌套列表初始化")]),t._v("\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("运算符")])]),t._v(" "),s("p",[t._v("常见的标准运算符（+、-、*、/、**）可以升级为按元素运算，")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ny "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nx"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("y\n\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("x"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 包括计算指数")]),t._v("\n\n\nX"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v("Y "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 通过逻辑运算符构建张量")]),t._v("\nX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("sum")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 对张量所有元素进行求和")]),t._v("\n")])])]),s("p",[t._v("张量连接")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dtype"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("float32"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dim"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 沿行的方向拼接")]),t._v("\ntorch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("cat"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("Y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("dim"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 沿列的方向拼接")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("广播机制")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a为3行1列")]),t._v("\nb "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# b为1行2列")]),t._v("\na "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" b "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# a复制列，b复制行，然后按元素相加")]),t._v("\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("索引和切片")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 最后一个元素， 第二个元素和第三个元素")]),t._v("\n\nX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("9")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 指定索引来写入矩阵")]),t._v("\n\nX"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("12")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 第一行、第二行赋值为12  ：表示沿轴1的所有元素")]),t._v("\n")])])]),s("ol",{attrs:{start:"5"}},[s("li",[t._v("节省内存")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("before "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# id()获取内存中对象的地址")]),t._v("\nY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Y "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" X  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# Y 内存引用地址已经变化")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" before  \n")])])]),s("p",[t._v("原地操作")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Z "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("zeros_like"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2337955335120")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" Z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" Y\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2337955335120")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" before "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+=")]),t._v(" Y\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("==")]),t._v(" before\n"),s("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("True")]),t._v("\n")])])]),s("ol",{attrs:{start:"6"}},[s("li",[t._v("转换为其他python对象")])]),t._v(" "),s("p",[t._v("torch与numpy数组共享底层内存")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" A "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" X"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("numpy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" B "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("A"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("type")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("B"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'numpy.ndarray'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'torch.Tensor'")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("p",[t._v("大小为1的张量与Python标量转换")]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" a "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">>")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("item"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("float")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),s("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("int")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("a"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.5000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"线性代数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线性代数"}},[t._v("#")]),t._v(" 线性代数")]),t._v(" "),s("ol",[s("li",[t._v("标量")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" torch\n\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\ny "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("tensor"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2.0")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nx "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v(" y"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" x"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("**")]),t._v("y\n")])])]),s("ol",{attrs:{start:"2"}},[s("li",[t._v("向量")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("x "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("ol",{attrs:{start:"3"}},[s("li",[t._v("矩阵")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("A "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\nA"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("T\n")])])]),s("ol",{attrs:{start:"4"}},[s("li",[t._v("张量")])]),t._v(" "),s("div",{staticClass:"language-python extra-class"},[s("pre",{pre:!0,attrs:{class:"language-python"}},[s("code",[t._v("X "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" torch"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("arange"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("24")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("reshape"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])])]),s("h3",{attrs:{id:"概率论"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#概率论"}},[t._v("#")]),t._v(" 概率论")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251117001721718.png",alt:"image-20251117001721718"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251117002025813.png",alt:"image-20251117002025813"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251117002244568.png",alt:"image-20251117002244568"}})]),t._v(" "),s("p",[t._v("看到103页了")]),t._v(" "),s("h2",{attrs:{id:"线性神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#线性神经网络"}},[t._v("#")]),t._v(" 线性神经网络")]),t._v(" "),s("h2",{attrs:{id:"多层感知机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多层感知机"}},[t._v("#")]),t._v(" 多层感知机")]),t._v(" "),s("h2",{attrs:{id:"深度学习计算"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#深度学习计算"}},[t._v("#")]),t._v(" 深度学习计算")]),t._v(" "),s("h2",{attrs:{id:"卷积神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#卷积神经网络"}},[t._v("#")]),t._v(" 卷积神经网络")]),t._v(" "),s("h2",{attrs:{id:"现代卷积神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#现代卷积神经网络"}},[t._v("#")]),t._v(" 现代卷积神经网络")]),t._v(" "),s("h2",{attrs:{id:"循环神经网络-下次看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#循环神经网络-下次看"}},[t._v("#")]),t._v(" 循环神经网络（下次看）")]),t._v(" "),s("p",[t._v("循环神经网络（recurrent neural networks,RNNS）,是具有隐状态的神经网络。")]),t._v(" "),s("p",[t._v("隐藏层是在从输入到输出的路径上隐藏的层，隐状态是在给定步骤所做的任何事情的输入，并且这些状态只能拿通过先前时间步的数据来计算。")]),t._v(" "),s("h3",{attrs:{id:"梯度问题"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#梯度问题"}},[t._v("#")]),t._v(" 梯度问题")]),t._v(" "),s("p",[t._v("1、梯度爆炸：反向传播过程中，梯度在逐层传递时出现“趋近于无穷大”的极端情况")]),t._v(" "),s("p",[t._v("核心原因："),s("strong",[t._v("权重矩阵的谱范数（权重值的平均大小）> 1")]),t._v("，且激活函数导数的绝对值 ≥ 1")]),t._v(" "),s("p",[t._v("2、梯度消失：反向传播过程中，梯度在逐层传递时出现“趋近于0”的极端情况")]),t._v(" "),s("p",[t._v("核心原因："),s("strong",[t._v("激活函数导数的绝对值<1，权重矩阵谱范数<=1")])]),t._v(" "),s("p",[t._v("3、梯度裁剪：将梯度g投影回给定半径的球")]),t._v(" "),s("p",[t._v("解决方案：")]),t._v(" "),s("ul",[s("li",[t._v("有限使用ReLU及其变体")]),t._v(" "),s("li",[t._v("避免使用sigmoid/tanh（深层网络中）")])]),t._v(" "),s("h2",{attrs:{id:"现代循环神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#现代循环神经网络"}},[t._v("#")]),t._v(" 现代循环神经网络")]),t._v(" "),s("h3",{attrs:{id:"门控循环单元gru"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#门控循环单元gru"}},[t._v("#")]),t._v(" 门控循环单元GRU")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125230204369.png",alt:"image-20251125230204369"}})]),t._v(" "),s("p",[t._v("GRU可以更好的捕获时间步距离很长的序列上的依赖关系。")]),t._v(" "),s("p",[t._v("重置门有助于捕获序列中的短期依赖关系。")]),t._v(" "),s("p",[t._v("更新门有助于捕获序列中的长期依赖关系。")]),t._v(" "),s("p",[t._v("重置们打开时，门控循环单元包括基本循环神经网络；更新们打开时，门控循环单元可以跳过子序列。")]),t._v(" "),s("h3",{attrs:{id:"长短期记忆网络lstm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#长短期记忆网络lstm"}},[t._v("#")]),t._v(" 长短期记忆网络LSTM")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125230235510.png",alt:"image-20251125230235510"}})]),t._v(" "),s("p",[t._v("长短期记忆网络有三种类型的门：输入门、遗忘门、输出门。")]),t._v(" "),s("p",[t._v("长短期记忆网络的隐藏层输出包括“隐状态”和“记忆元”。只有隐状态会传递到输出层，而记忆元完全属于内部信息。")]),t._v(" "),s("p",[t._v("长短期记忆网络可以缓解梯度消失和梯度爆炸。")]),t._v(" "),s("h3",{attrs:{id:"深度循环神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#深度循环神经网络"}},[t._v("#")]),t._v(" 深度循环神经网络")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125230510373.png",alt:"image-20251125230510373"}})]),t._v(" "),s("p",[t._v("深度循环神经网络中，隐状态的信息北传递到当前层的下一时间步和下一层的当前时间步。")]),t._v(" "),s("p",[t._v("深度循环神经网络需要大量的调参来确保收敛，模型的初始化也需要谨慎。")]),t._v(" "),s("h3",{attrs:{id:"双向循环神经网络"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#双向循环神经网络"}},[t._v("#")]),t._v(" 双向循环神经网络")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125230648110.png",alt:"image-20251125230648110"}})]),t._v(" "),s("p",[t._v("双向循环神经网络，每个时间步的隐状态由当前时间步的前后数据同时决定")]),t._v(" "),s("p",[t._v("双向循环神经网络与概率图模型的“前向-后向”算法具有相似性。")]),t._v(" "),s("p",[t._v("双向循环神经网络主要用于序列编码和给定双向上下文的观测估计。")]),t._v(" "),s("p",[t._v("由于梯度链更长，因此训练代价非常高。")]),t._v(" "),s("h3",{attrs:{id:"机器翻译与数据集"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#机器翻译与数据集"}},[t._v("#")]),t._v(" 机器翻译与数据集")]),t._v(" "),s("p",[t._v("机器翻译是指将序列从一种语言自动翻译成另一种语言。")]),t._v(" "),s("h3",{attrs:{id:"编码器-解码器架构"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编码器-解码器架构"}},[t._v("#")]),t._v(" 编码器-解码器架构")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125231349295.png",alt:"image-20251125231349295"}})]),t._v(" "),s("p",[t._v("“编码器-解码器”架构可以将长度可变的序列作为输入和输出，因此适用于机器翻译等序列转换问题。")]),t._v(" "),s("p",[t._v("编码器将长度可变的序列作为输入，并将其转换为固定形状的编码状态。")]),t._v(" "),s("p",[t._v("解码器将具有固定形状的编码状态映射为长度可变的序列。")]),t._v(" "),s("h3",{attrs:{id:"序列到序列学习seq2seq"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#序列到序列学习seq2seq"}},[t._v("#")]),t._v(" 序列到序列学习seq2seq")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/image-20251125232228137.png",alt:"image-20251125232228137"}})]),t._v(" "),s("p",[t._v("使用RNN-Encoder和RNN-decoder的seq2seq学习")]),t._v(" "),s("h2",{attrs:{id:"注意力机制"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意力机制"}},[t._v("#")]),t._v(" 注意力机制")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/631398525",target:"_blank",rel:"noopener noreferrer"}},[t._v("具体可参考知乎的一篇文章"),s("OutboundLink")],1)]),t._v(" "),s("h3",{attrs:{id:"注意力提示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意力提示"}},[t._v("#")]),t._v(" 注意力提示")]),t._v(" "),s("p",[s("strong",[t._v("非自主性提示")]),t._v("是基于环境中物体的突出性和易见性。假如面前有五个物品：一份报纸、一篇研究论文、一杯咖啡、一本笔记本和一本书。所有纸质品都是黑白印刷的，单咖啡杯是红色的。咖啡杯在环境中就会比较显眼，不由自主地引起人们注意。")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121155737742.png",alt:"image-20251121155737742"}}),t._v(" "),s("p",[t._v("喝咖啡后，我们会变得兴奋并且想读书，所以转过头，重新聚焦眼睛，然后看看书。此时选择书是收到了认知和意识的控制。")]),t._v(" "),s("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121160016919.png",alt:"image-20251121160016919"}}),t._v(" "),s("p",[t._v("在注意力的背景下，自主性提示被称为"),s("strong",[t._v("查询（query）")]),t._v("。给定任何查询，注意力机制通过注意力汇聚，将选择引导至感官输出。在注意力机制中，这些感官输出被称为"),s("strong",[t._v("值（value）")]),t._v("，每个值与一个**键（key）**对应，可以想象为感官输入的非自主性提示。")]),t._v(" "),s("p",[t._v("注意力机制通过注意力汇聚，将查询（自主性提示）和键（非自主性提示）结合到一起，实现对值的选择倾向。")]),t._v(" "),s("img",{staticStyle:{zoom:"80%"},attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121154555269.png",alt:"image-20251121154555269"}}),t._v(" "),s("p",[t._v("采用平均汇聚：")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121165827681.png",alt:"image-20251121165827681"}})]),t._v(" "),s("h3",{attrs:{id:"注意力汇聚"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意力汇聚"}},[t._v("#")]),t._v(" 注意力汇聚")]),t._v(" "),s("p",[t._v("Nadaraya-Watson核回归模型\n$$\nf(x) = \\sum_{i=1}^{n} \\frac{K(x - x_i)}{\\sum_{j=1}^{n} K(x - x_j)} y_i,\n$$\nK是核(kernel)，按注意力机制框架重写\n$$\nf(x) = \\sum_{i=1}^{n} \\alpha(x, x_i) y_i\n$$\nx是查询,(xi，yi)是键值对，注意力汇聚是yi的加权平均。x和键xi之间的关系建模称为注意力权重。模型的所有键值对注意力权重非负，总和为1.")]),t._v(" "),s("p",[t._v("考虑一个高斯核：\n$$\nK(u) = \\frac{1}{\\sqrt{2\\pi}} \\exp(-\\frac{u^2}{2}).\n$$\n带入以上公式得到：\n$$\nf(x) = \\sum_{i=1}^{n} \\alpha(x, x_{i}) y_{i}\n= \\sum_{i=1}^{n} \\frac{\\exp(-\\frac{1}{2}(x - x_{i})^{2})}{\\sum_{j=1}^{n} \\exp(-\\frac{1}{2}(x - x_{j})^{2})} y_{i}\n= \\sum_{i=1}^{n} \\mathrm{softmax}\\left(-\\frac{1}{2}(x - x_{i})^{2}\\right) y_{i}.\n$$\n如果一个键xi越是接近查询x，那么分配给这个键对应值yi的注意力权重就会越大。")]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121165810914.png",alt:"image-20251121165810914"}})]),t._v(" "),s("p",[s("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/image-20251121170114865.png",alt:"image-20251121170114865"}})]),t._v(" "),s("h3",{attrs:{id:"注意力评分函数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注意力评分函数"}},[t._v("#")]),t._v(" 注意力评分函数")]),t._v(" "),s("p",[t._v("将注意力汇聚的输出计算可以作为值的加权平均，选择不同的注意力评分函数会带来不同的注意力汇聚操作。")]),t._v(" "),s("p",[t._v("当查询和键是不同长度的矢量时，可以使用加性注意力评分函数。当它们长度相同时，使用缩放点积注意力评分函数计算效率更高")]),t._v(" "),s("h3",{attrs:{id:"bahdanau注意力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bahdanau注意力"}},[t._v("#")]),t._v(" Bahdanau注意力")]),t._v(" "),s("h3",{attrs:{id:"多头注意力"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#多头注意力"}},[t._v("#")]),t._v(" 多头注意力")]),t._v(" "),s("h3",{attrs:{id:"transformer-要重点看"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#transformer-要重点看"}},[t._v("#")]),t._v(" Transformer（要重点看）")]),t._v(" "),s("p",[s("a",{attrs:{href:"https://www.zhihu.com/question/580810624/answer/1976600872675977173",target:"_blank",rel:"noopener noreferrer"}},[t._v("知乎Transformer介绍文章"),s("OutboundLink")],1)]),t._v(" "),s("h2",{attrs:{id:"阅读进度"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#阅读进度"}},[t._v("#")]),t._v(" 阅读进度")]),t._v(" "),s("p",[t._v("目前读到了注意力机制的后半小节，后面需要再看看循环神经网络部分。")])])}),[],!1,null,null,null);s.default=r.exports}}]);